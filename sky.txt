Selected Files Directory Structure:

└── ./
    ├── src
    │   ├── app
    │   │   ├── api
    │   │   │   └── source
    │   │   │       └── route.ts
    │   │   ├── craft
    │   │   │   ├── [slug]
    │   │   │   │   ├── CraftPageClient.tsx
    │   │   │   │   ├── CraftPageWrapper.tsx
    │   │   │   │   └── page.tsx
    │   │   │   ├── layout.tsx
    │   │   │   └── page.tsx
    │   │   ├── global-error.tsx
    │   │   ├── globals.css
    │   │   ├── layout.tsx
    │   │   └── page.tsx
    │   ├── components
    │   │   ├── code
    │   │   │   ├── code-scrollbar.css
    │   │   │   ├── CodeBlock.tsx
    │   │   │   └── prism-theme.css
    │   │   ├── craft
    │   │   │   ├── CodePanel.tsx
    │   │   │   ├── ComponentPreview.tsx
    │   │   │   ├── CopyCodeButton.tsx
    │   │   │   ├── CraftNavDrawer.tsx
    │   │   │   ├── DemoContainer.tsx
    │   │   │   └── PreviewDock.tsx
    │   │   ├── demos
    │   │   │   ├── adaptive-tooltip
    │   │   │   │   └── AdaptiveTooltipDemo.tsx
    │   │   │   ├── filter-chips
    │   │   │   │   └── FilterChipsDemo.tsx
    │   │   │   ├── magnetic-button
    │   │   │   │   └── MagneticButtonDemo.tsx
    │   │   │   └── scroll-reveal-text
    │   │   │       └── ScrollRevealTextDemo.tsx
    │   │   ├── layout
    │   │   │   └── Footer.tsx
    │   │   ├── mdx
    │   │   │   ├── Callout.tsx
    │   │   │   ├── PropsTable.tsx
    │   │   │   └── Steps.tsx
    │   │   ├── ui
    │   │   │   ├── button.tsx
    │   │   │   ├── drawer.tsx
    │   │   │   └── progressive-blur.tsx
    │   │   ├── ClientProviders.tsx
    │   │   └── ErrorBoundary.tsx
    │   ├── content
    │   │   ├── adaptive-tooltip
    │   │   │   ├── AdaptiveTooltip.tsx
    │   │   │   └── index.mdx
    │   │   ├── filter-chips
    │   │   │   ├── FilterChips.tsx
    │   │   │   └── index.mdx
    │   │   ├── magnetic-button
    │   │   │   ├── index.mdx
    │   │   │   └── MagneticButton.tsx
    │   │   └── scroll-reveal-text
    │   │       ├── index.mdx
    │   │       └── ScrollRevealText.tsx
    │   ├── hooks
    │   │   └── use-mounted.ts
    │   ├── lib
    │   │   ├── docs
    │   │   │   ├── engine.ts
    │   │   │   ├── schema.ts
    │   │   │   └── SectionRenderer.tsx
    │   │   ├── mdx
    │   │   │   ├── compiler.ts
    │   │   │   ├── components.tsx
    │   │   │   ├── frontmatter-schema.ts
    │   │   │   ├── index.ts
    │   │   │   ├── loader.ts
    │   │   │   ├── MDXContent.tsx
    │   │   │   ├── performance.ts
    │   │   │   ├── preload.ts
    │   │   │   ├── SourceCodeWrapper.tsx
    │   │   │   └── types.ts
    │   │   ├── registry
    │   │   │   ├── registry.json
    │   │   │   ├── resolver.ts
    │   │   │   └── schema.ts
    │   │   ├── errors.ts
    │   │   ├── source-reader.ts
    │   │   ├── types.ts
    │   │   └── utils.ts
    │   └── tests
    │       └── unit
    │           └── source-reader.spec.ts
    ├── next.config.ts
    ├── tailwind.config.ts
    └── vitest.config.ts



--- next.config.ts ---

import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  eslint: {
    ignoreDuringBuilds: true,
  },
  pageExtensions: ['js', 'jsx', 'ts', 'tsx', 'md', 'mdx'],
  images: {
    remotePatterns: [
      {
        protocol: 'https',
        hostname: '**',
      },
      {
        protocol: 'http',
        hostname: '**',
      },
    ],
  },
};

export default nextConfig;

--- src/app/api/source/route.ts ---

import { NextRequest, NextResponse } from "next/server";
import { getDemoSourceCodeAsync, getComponentSourceCodeAsync } from "@/lib/source-reader";
import { getComponentMetadata } from "@/lib/registry/resolver";
import { SecurityError } from "@/lib/errors";

/**
 * API Route: /api/source
 * 
 * Serves component source code for display in the UI.
 * 
 * Query params:
 *   type: "demo" | "component"
 *   name: component ID (e.g., "adaptive-tooltip")
 * 
 * Security features:
 *   - Rate limiting: 10 requests per IP per 10 seconds
 *   - Paid component gating: returns 403 for paid components
 *   - Input validation via source-reader (throws SecurityError)
 */

/* ──────────────────────────────────────────────────────────────────────────────
 * RATE LIMITER
 * 
 * In-memory sliding window rate limiter.
 * NOTE: This is for development only. For production, use Redis/Upstash.
 * ────────────────────────────────────────────────────────────────────────────── */

const RATE_LIMIT_WINDOW_MS = 10_000; // 10 seconds
const RATE_LIMIT_MAX_REQUESTS = 10;

// Map of IP -> array of request timestamps
const rateLimitMap = new Map<string, number[]>();

// Periodic cleanup to prevent memory leaks (run every minute)
const CLEANUP_INTERVAL_MS = 60_000;
let cleanupInterval: NodeJS.Timeout | null = null;

function startCleanupInterval() {
  if (cleanupInterval) return;
  cleanupInterval = setInterval(() => {
    const now = Date.now();
    for (const [ip, timestamps] of rateLimitMap.entries()) {
      const valid = timestamps.filter(t => now - t < RATE_LIMIT_WINDOW_MS);
      if (valid.length === 0) {
        rateLimitMap.delete(ip);
      } else {
        rateLimitMap.set(ip, valid);
      }
    }
  }, CLEANUP_INTERVAL_MS);
}

function isRateLimited(ip: string): boolean {
  const now = Date.now();
  const requests = rateLimitMap.get(ip) || [];

  // Filter to only requests within the window
  const recentRequests = requests.filter(t => now - t < RATE_LIMIT_WINDOW_MS);

  if (recentRequests.length >= RATE_LIMIT_MAX_REQUESTS) {
    return true;
  }

  // Record this request
  recentRequests.push(now);
  rateLimitMap.set(ip, recentRequests);

  // Start cleanup if not already running
  startCleanupInterval();

  return false;
}

/* ──────────────────────────────────────────────────────────────────────────────
 * ROUTE HANDLER
 * ────────────────────────────────────────────────────────────────────────────── */

export async function GET(request: NextRequest) {
  // Extract client IP
  const forwardedFor = request.headers.get("x-forwarded-for");
  const ip = forwardedFor?.split(",")[0].trim() || "unknown";

  // Rate limit check
  if (isRateLimited(ip)) {
    return NextResponse.json(
      { error: "Rate limit exceeded. Try again in a few seconds." },
      { status: 429 }
    );
  }

  const { searchParams } = new URL(request.url);
  const type = searchParams.get("type");
  const name = searchParams.get("name");

  // Validate required params
  if (!type || !name) {
    return NextResponse.json(
      { error: "Missing required params: type, name" },
      { status: 400 }
    );
  }

  // Validate type param
  if (type !== "demo" && type !== "component") {
    return NextResponse.json(
      { error: "Invalid type. Must be 'demo' or 'component'" },
      { status: 400 }
    );
  }

  // Check if component is paid (gate access)
  const metadata = getComponentMetadata(name);
  if (metadata?.pricing === "paid") {
    return NextResponse.json(
      { error: "This is a paid component. Access denied." },
      { status: 403 }
    );
  }

  // Attempt to read source code (non-blocking async)
  try {
    let code: string | null = null;

    if (type === "demo") {
      code = await getDemoSourceCodeAsync(name);
    } else {
      code = await getComponentSourceCodeAsync(name);
    }

    if (!code) {
      return NextResponse.json(
        { error: `Source not found for ${type}: ${name}` },
        { status: 404 }
      );
    }

    return NextResponse.json({ code });
  } catch (err) {
    // Handle security errors specifically
    if (err instanceof SecurityError) {
      console.warn(`[/api/source] Security violation: ${err.message} (code: ${err.code})`);
      return NextResponse.json(
        { error: "Invalid request" },
        { status: 400 }
      );
    }

    // Generic error handling
    console.error("[/api/source] Unexpected error:", err);
    return NextResponse.json(
      { error: "Internal server error" },
      { status: 500 }
    );
  }
}


--- src/app/craft/[slug]/CraftPageClient.tsx ---

"use client";

import * as React from "react";
import { CodePanelProvider, useCodePanel } from "@/components/craft/CodePanelContext";
import { CodePanel } from "@/components/craft/CodePanel";
import { AnimatePresence } from "framer-motion";

interface CraftPageClientProps {
    slug: string;
    children: React.ReactNode;
}

function CodePanelColumn({ slug }: { slug: string }) {
    const { showCode, setShowCode } = useCodePanel();

    React.useEffect(() => {
        const handleKeyDown = (e: KeyboardEvent) => {
            if (e.key === "Escape" && showCode) {
                setShowCode(false);
            }
        };
        window.addEventListener("keydown", handleKeyDown);
        return () => window.removeEventListener("keydown", handleKeyDown);
    }, [showCode, setShowCode]);

    return (
        <AnimatePresence>
            {showCode && (
                <div className="relative lg:order-1">
                    {/* Same structure as the preview column */}
                    <div className="sticky top-0 h-dvh lg:h-screen p-2">
                        <CodePanel componentName={slug} />
                    </div>
                </div>
            )}
        </AnimatePresence>
    );
}

export function CraftPageClient({ slug, children }: CraftPageClientProps) {
    return (
        <CodePanelProvider>
            {children}
            {/* Code Panel - positioned fixed over the docs section */}
            <CodePanelColumn slug={slug} />
        </CodePanelProvider>
    );
}


--- src/app/craft/[slug]/CraftPageWrapper.tsx ---

"use client";

import * as React from "react";
import { CodePanel } from "@/components/craft/CodePanel";
import { AnimatePresence } from "framer-motion";

// Simple context for code panel state
const CodePanelContext = React.createContext<{
    showCode: boolean;
    toggleCode: () => void;
}>({ showCode: false, toggleCode: () => { } });

export const useCodePanel = () => React.useContext(CodePanelContext);

interface CraftPageWrapperProps {
    slug: string;
    children: React.ReactNode;
}

export function CraftPageWrapper({ slug, children }: CraftPageWrapperProps) {
    const [showCode, setShowCode] = React.useState(false);
    const toggleCode = React.useCallback(() => setShowCode(prev => !prev), []);

    // ESC to close
    React.useEffect(() => {
        const handleKeyDown = (e: KeyboardEvent) => {
            if (e.key === "Escape" && showCode) setShowCode(false);
        };
        window.addEventListener("keydown", handleKeyDown);
        return () => window.removeEventListener("keydown", handleKeyDown);
    }, [showCode]);

    return (
        <CodePanelContext.Provider value={{ showCode, toggleCode }}>
            {children}

            {/* Code Panel Overlay - SAME size as preview column */}
            <AnimatePresence>
                {showCode && (
                    <div className="fixed top-0 left-0 bottom-0 w-full lg:w-1/2 z-[100] p-2">
                        <CodePanel componentName={slug} />
                    </div>
                )}
            </AnimatePresence>
        </CodePanelContext.Provider>
    );
}


--- src/app/craft/[slug]/page.tsx ---

import { notFound } from "next/navigation";
import Link from "next/link";
import { Icon } from "@iconify/react";
import { getAllComponentsMetadata } from "@/lib/registry/resolver";
import { ComponentPreview } from "@/components/craft/ComponentPreview";
import { buildDocsPage } from "@/lib/docs/engine";
import { SectionRenderer } from "@/lib/docs/SectionRenderer";
import { ProgressiveBlur } from "@/components/ui/progressive-blur";
import { CraftPageWrapper } from "./CraftPageWrapper";

export const dynamic = 'force-dynamic';

interface ComponentPageProps {
  params: Promise<{ slug: string }>;
}

export async function generateStaticParams() {
  const components = getAllComponentsMetadata();
  return components.map((component) => ({
    slug: component.id,
  }));
}

export default async function ComponentPage({ params }: ComponentPageProps) {
  const { slug } = await params;

  let config;
  try {
    config = await buildDocsPage(slug);
  } catch (e) {
    notFound();
  }

  const { title, pricing, prev, next } = config;

  return (
    <CraftPageWrapper slug={slug}>
      <main className="min-h-screen bg-background text-foreground selection:bg-primary/30">
        <div className="w-full">
          <div className="flex flex-col lg:grid lg:grid-cols-2">
            {/* Right Column: Sticky Preview */}
            <div className="relative z-40 lg:order-2">
              <div className="sticky top-0 h-dvh lg:h-screen p-2">
                <ComponentPreview name={slug} />
              </div>
            </div>

            {/* Left Column: Docs Content */}
            <div className="relative lg:order-1" data-docs-section>
              <ProgressiveBlur position="top" height="120px" className="lg:w-1/2" />
              <ProgressiveBlur position="bottom" height="100px" className="lg:w-1/2" />

              {/* Header breadcrumb */}
              <header className="sticky top-0 z-80 px-5 lg:px-8 py-3">
                <div className="flex h-[46px] items-center gap-3">
                  <Link href="/craft" className="hidden md:block text-foreground/50 hover:text-foreground transition-colors text-base font-medium">
                    Components
                  </Link>
                  <div className="hidden md:block size-1.5 rounded-full bg-primary/40" />
                  <span className={`${pricing === "paid" ? "text-amber-500" : "text-foreground/50"} text-base font-medium`}>
                    {pricing === "paid" ? "Pro" : "Free"}
                  </span>
                  <div className="size-1.5 rounded-full bg-primary/40" />
                  <span className="text-foreground/50 text-base font-medium truncate">{title}</span>
                </div>
              </header>

              {/* Main docs content */}
              <div className="mt-8 lg:mt-32 mb-[9vh] px-5 lg:px-8">
                <SectionRenderer config={config} />

                {/* Navigation */}
                <div className="relative z-10 mb-[10vh] mt-20 lg:mt-[20vh]">
                  <div className="h-px w-full bg-linear-to-r from-transparent via-foreground/10 to-transparent mb-12" />
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    {prev ? (
                      <Link
                        href={`/craft/${prev.id}`}
                        className="group relative flex flex-col gap-2 rounded-2xl border border-border/5 bg-muted/30 p-6 transition-all hover:bg-muted/50 hover:border-border/10"
                      >
                        <span className="text-foreground/40 flex items-center gap-1 font-mono text-[10px] uppercase tracking-wider">
                          <Icon icon="lucide:arrow-left" className="size-3 transition-transform group-hover:-translate-x-1" />
                          Previous
                        </span>
                        <p className="text-sm font-medium tracking-tight text-foreground/80 group-hover:text-foreground transition-colors">
                          {prev.title}
                        </p>
                      </Link>
                    ) : <div />}

                    {next ? (
                      <Link
                        href={`/craft/${next.id}`}
                        className="group relative flex flex-col gap-2 rounded-2xl border border-border/5 bg-muted/30 p-6 text-right transition-all hover:bg-muted/50 hover:border-border/10"
                      >
                        <span className="text-foreground/40 flex items-center justify-end gap-1 font-mono text-[10px] uppercase tracking-wider">
                          Next
                          <Icon icon="lucide:arrow-right" className="size-3 transition-transform group-hover:translate-x-1" />
                        </span>
                        <p className="text-sm font-medium tracking-tight text-foreground/80 group-hover:text-foreground transition-colors">
                          {next.title}
                        </p>
                      </Link>
                    ) : <div />}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </CraftPageWrapper>
  );
}


--- src/app/craft/layout.tsx ---

export default function CraftLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <div className="min-h-screen bg-background text-foreground relative">
      <div className="w-full">
        {children}
      </div>
    </div>
  );
}


--- src/app/craft/page.tsx ---

import Link from "next/link";
import { getAllComponentsMetadata } from "@/lib/registry/resolver";
import { CraftNavDrawer } from "@/components/craft/CraftNavDrawer";
import { Icon } from "@iconify/react";

export default function CraftPage() {
  const components = getAllComponentsMetadata();

  return (
    <div className="mx-auto max-w-2xl w-full flex flex-col animate-in fade-in slide-in-from-bottom-4 duration-1000 ease-out fill-mode-backwards">
      
      {/* Sticky Header */}
      <header className="sticky top-0 z-50 bg-background/80 backdrop-blur-lg border-b border-border/5 px-6 py-4">
        <div className="flex items-center justify-between">
          <div className="flex items-center gap-4">
            <Link 
              href="/" 
              className="flex items-center justify-center w-8 h-8 rounded-full border border-border/40 text-muted-foreground transition-all duration-300 outline-none hover:bg-muted/50"
            >
              <Icon icon="lucide:arrow-left" className="w-3.5 h-3.5" />
            </Link>
            <CraftNavDrawer 
              components={components} 
              trigger={
                <button className="inline-flex items-center gap-2 px-3 py-1 rounded-full border border-border/10 bg-muted/20 text-muted-foreground hover:text-foreground hover:bg-muted/70 transition-all duration-300 w-fit group outline-none">
                  <Icon icon="lucide:layout-grid" className="w-3 h-3 group-hover:scale-110 transition-transform" />
                  <span className="text-xs font-medium tracking-tight">Library</span>
                </button>
              }
            />
          </div>
        </div>
      </header>

      <div className="px-6 py-20 flex flex-col gap-20">
        <div className="flex flex-col gap-4">
          <h1 className="text-4xl font-medium tracking-tight leading-tight text-foreground">
            Crafting the <span className="text-muted-foreground/30 font-serif">Future</span>.
          </h1>
          <p className="text-base text-muted-foreground/50 leading-relaxed font-light tracking-tight w-full">
            A laboratory for refined components and motion experiments.
            Focused on the intersection of aesthetics and high-end interaction.
          </p>
        </div>

        {/* Component List */}
        <div className="grid grid-cols-1 md:grid-cols-2 border-t border-l border-border/25">
          {components.map((component, index) => (
            <Link
              key={component.id}
              href={`/craft/${component.id}`}
              className="group relative flex flex-col gap-4 p-5 border-b border-r border-border/25 outline-none"
              style={{ animationDelay: `${index * 50}ms` }}
            >
              <div className="flex flex-col gap-1.5 relative z-10">
                <h3 className="text-[17px] font-medium text-foreground tracking-tight">
                  {component.title}
                </h3>
              </div>
            </Link>
          ))}
        </div>
      </div>
    </div>
  );
}


--- src/app/global-error.tsx ---

"use client";

export default function GlobalError({
  error,
  reset,
}: {
  error: Error & { digest?: string };
  reset: () => void;
}) {
  return (
    <html>
      <body className="min-h-screen bg-background text-foreground flex items-center justify-center p-4">
        <div className="max-w-md w-full text-center space-y-6">
          <div className="space-y-2">
            <h1 className="text-2xl font-bold text-destructive">
              Something went wrong!
            </h1>
            <p className="text-muted-foreground">
              An unexpected error occurred. Please try again.
            </p>
          </div>
          <button
            onClick={() => reset()}
            className="px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors"
          >
            Try again
          </button>
          {process.env.NODE_ENV === "development" && (
            <details className="mt-4 text-left">
              <summary className="cursor-pointer text-sm text-muted-foreground hover:text-foreground">
                Error details
              </summary>
              <pre className="mt-2 text-xs bg-muted p-2 rounded overflow-auto">
                {error.message}
                {error.stack && (
                  <div className="mt-2 text-muted-foreground">
                    {error.stack}
                  </div>
                )}
                {error.digest && (
                  <div className="mt-2 text-muted-foreground">
                    Digest: {error.digest}
                  </div>
                )}
              </pre>
            </details>
          )}
        </div>
      </body>
    </html>
  );
}


--- src/app/globals.css ---

@import "tailwindcss";

/* Local fonts can be added here when available */

@custom-variant dark (&:is(.dark *));

/* -------------------------------------------------------------------------- */
/* THEME TOKEN BRIDGE (Tailwind <-> CSS Variables)                             */
/* -------------------------------------------------------------------------- */
@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);

  --font-sans: var(--font-sans);
  --font-mono: var(--font-mono);
  --font-serif: var(--font-serif);

  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);

  --color-muted-2: var(--muted-2);
  --color-muted-3: var(--muted-3);
  --shadow-glass: 0 0 0 1px rgba(255, 255, 255, 0.05), 0 8px 32px 0 rgba(0, 0, 0, 0.3);
}

/* -------------------------------------------------------------------------- */
/* LIGHT THEME (DEFAULT)                                                       */
/* -------------------------------------------------------------------------- */
:root {
  --background: #f8f8f8;
  --foreground: #1f1f1f;

  --card: #fcfcfc;
  --card-foreground: #1f1f1f;

  --popover: #fcfcfc;
  --popover-foreground: #1f1f1f;

  --primary: #63493f;
  --primary-foreground: #ffffff;

  --secondary: #ffdfb1;
  --secondary-foreground: #592d1c;

  --muted: #eeeeee;
  --muted-foreground: #636363;
  --muted-2: #f3f3f3;
  --muted-3: #e5e5e5;

  --accent: #e8e8e8;
  --accent-foreground: #1f1f1f;

  --destructive: #e55032;

  --border: #d7d7d7;
  --input: #d7d7d7;
  --ring: #63493f;

  --chart-1: #63493f;
  --chart-2: #ffdfb1;
  --chart-3: #e8e8e8;
  --chart-4: #ffe7c7;
  --chart-5: #63493f;

  --sidebar: #fcfcfc;
  --sidebar-foreground: #242424;
  --sidebar-primary: #353535;
  --sidebar-primary-foreground: #fcfcfc;
  --sidebar-accent: #f8f8f8;
  --sidebar-accent-foreground: #353535;
  --sidebar-border: #ebebeb;
  --sidebar-ring: #b4b4b4;

  --font-sans: 'Inter Tight', ui-sans-serif, system-ui, -apple-system,
    BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
    'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji',
    'Segoe UI Symbol', 'Noto Color Emoji';

  --font-poly: 'PolySans', ui-sans-serif, system-ui, sans-serif;

  --font-serif: 'Inter Tight', ui-serif, Georgia, Cambria,
    'Times New Roman', Times, serif;

  --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
    'Liberation Mono', 'Courier New', monospace;

  /* Mathematical Typography Scale (1.25 - Major Third) */
  --text-xs: 0.64rem;
  /* 10.24px */
  --text-sm: 0.8rem;
  /* 12.8px */
  --text-base: 1rem;
  /* 16px */
  --text-lg: 1.25rem;
  /* 20px */
  --text-xl: 1.563rem;
  /* 25px */
  --text-2xl: 1.953rem;
  /* 31.25px */
  --text-3xl: 2.441rem;
  /* 39.06px */
  --text-4xl: 3.052rem;
  /* 48.83px */
  --text-5xl: 3.815rem;
  /* 61.04px */

  --radius: 0.5rem;

  --shadow-2xs: 0 1px 3px rgb(0 0 0 / 0.05);
  --shadow-xs: 0 1px 3px rgb(0 0 0 / 0.05);
  --shadow-sm: 0 1px 3px rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
  --shadow: 0 1px 3px rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
  --shadow-md: 0 1px 3px rgb(0 0 0 / 0.1), 0 2px 4px -1px rgb(0 0 0 / 0.1);
  --shadow-lg: 0 1px 3px rgb(0 0 0 / 0.1), 0 4px 6px -1px rgb(0 0 0 / 0.1);
  --shadow-xl: 0 1px 3px rgb(0 0 0 / 0.1), 0 8px 10px -1px rgb(0 0 0 / 0.1);
  --shadow-2xl: 0 1px 3px rgb(0 0 0 / 0.25);
}

/* -------------------------------------------------------------------------- */
/* DARK THEME                                                                  */
/* -------------------------------------------------------------------------- */
.dark {
  --background: #18181b;
  /* zinc-900 - Darker but distinguishable from preview */
  --foreground: #eeeeee;

  --card: #121212;
  --card-foreground: #eeeeee;

  --popover: #121212;
  --popover-foreground: #eeeeee;

  --primary: #fcdfc2;
  --primary-foreground: #0a191a;

  --secondary: #3a3128;
  --secondary-foreground: #fcdfc2;

  --muted: #1c1c1c;
  --muted-foreground: #b4b4b4;
  --muted-2: #161616;
  --muted-3: #242424;

  --accent: #2b2b2b;
  --accent-foreground: #eeeeee;

  --destructive: #e55032;

  --border: #27272a;
  --input: #484848;
  --ring: #fcdfc2;

  --chart-1: #fcdfc2;
  --chart-2: #3a3128;
  --chart-3: #2b2b2b;
  --chart-4: #423930;
  --chart-5: #fcdfc2;

  --sidebar: #18181d;
  --sidebar-foreground: #f5f5f5;
  --sidebar-primary: #1d4eda;
  --sidebar-primary-foreground: #ffffff;
  --sidebar-accent: #26262b;
  --sidebar-accent-foreground: #f5f5f5;
  --sidebar-border: #26262b;
  --sidebar-ring: #d3d3db;
}

/* -------------------------------------------------------------------------- */
/* BASE STYLES                                                                 */
/* -------------------------------------------------------------------------- */
@layer base {
  * {
    /* outline removed as per request */
  }

  html {
    overflow-y: scroll;
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  html::-webkit-scrollbar {
    display: none;
  }

  body {
    @apply bg-background text-foreground font-sans antialiased leading-relaxed tracking-normal;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    font-family: var(--font-sans);
  }

  ::selection {
    background-color: #d9f99d;
    color: #1a1a1a;
  }
}

/* -------------------------------------------------------------------------- */
/* UTILITIES                                                                   */
/* -------------------------------------------------------------------------- */
@layer utilities {
  .scrollbar-hide {
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  /* Documentation typography styles - 20px (1.25rem) consistent across all breakpoints */
  .docs-h3 {
    font-size: 1.25rem;
    line-height: 1.6;
    @apply font-medium tracking-tight mt-10 mb-4 text-foreground;
  }

  .docs-p {
    font-size: 1.25rem;
    line-height: 1.75;
    @apply text-muted-foreground mb-4;
  }

  .docs-ul {
    @apply my-4 space-y-3;
  }

  .docs-li {
    font-size: 1.25rem;
    line-height: 1.75;
    @apply text-muted-foreground relative pl-6;
  }

  .docs-li::before {
    content: "-";
    @apply absolute left-0 top-0 text-muted-foreground/60 font-medium;
  }

  .docs-article {
    font-size: 1.25rem;
    line-height: 1.75;
    @apply mt-8;
  }

  .docs-article p,
  .docs-article li,
  .docs-article td {
    font-size: 1.25rem;
    line-height: 1.75;
  }

  .docs-code-wrapper {
    @apply relative my-4 overflow-hidden rounded-xl border border-border/10 bg-zinc-800;
  }

  .docs-copy-button {
    @apply absolute right-3 top-3 flex size-8 items-center justify-center rounded-lg bg-white/5 hover:bg-white/10 transition-colors cursor-pointer;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Custom scrollbar styles for preview containers */
  .scrollbar-thin {
    scrollbar-width: thin;
  }

  .scrollbar-thin::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  .scrollbar-thin::-webkit-scrollbar-track {
    background: transparent;
  }

  .scrollbar-thin::-webkit-scrollbar-thumb {
    background-color: hsl(var(--border) / 0.4);
    border-radius: 4px;
    transition: background-color 0.2s;
  }

  .scrollbar-thin:hover::-webkit-scrollbar-thumb {
    background-color: hsl(var(--border) / 0.6);
  }

  .scrollbar-thumb-border\/40::-webkit-scrollbar-thumb {
    background-color: hsl(var(--border) / 0.4);
  }

  .scrollbar-thumb-border\/60::-webkit-scrollbar-thumb {
    background-color: hsl(var(--border) / 0.6);
  }

  .scrollbar-track-transparent::-webkit-scrollbar-track {
    background: transparent;
  }
}

--- src/app/layout.tsx ---

import type { Metadata } from "next";
import { Inter_Tight } from "next/font/google";
import localFont from "next/font/local";
import "./globals.css";
import { ClientProviders } from "@/components/ClientProviders";

// Primary font for UI (Inter Tight with mathematical scale)
const interTight = Inter_Tight({
  subsets: ["latin"],
  variable: "--font-sans",
  display: "swap",
  weight: ["300", "400", "500", "600", "700", "800"],
});

// Secondary font for components (PolySans)
const polySans = localFont({
  src: [
    {
      path: "../../public/font/PolySansNeutral.ttf",
      weight: "400",
      style: "normal",
    }
  ],
  variable: "--font-poly",
  display: "swap",
});

export const metadata: Metadata = {
  title: "Skie — Experiment",
  description: "A premium component library showcase inspired by modern design principles.",
};

export default function RootLayout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="en" className="dark">
      <body
        className={`${interTight.variable} ${polySans.variable} antialiased min-h-screen bg-background text-foreground font-sans`}
      >
        <ClientProviders>{children}</ClientProviders>
      </body>
    </html>
  );
}


--- src/app/page.tsx ---

import Link from "next/link";
import { Footer } from "@/components/layout/Footer";
import { getAllComponentsMetadata } from "@/lib/registry/resolver";

function pickRandom<T>(arr: T[], count: number) {
  return [...arr].sort(() => 0.5 - Math.random()).slice(0, count);
}

export default function Home() {
  const allComponents = getAllComponentsMetadata();
  const featuredComponents = pickRandom(allComponents, 3);

  return (
    <main className="min-h-screen bg-background">
      <div className="mx-auto w-full max-w-5xl px-6 pt-24 pb-20">
        <div className="flex flex-col gap-16 sm:gap-24 animate-in fade-in slide-in-from-bottom-8 duration-1000 ease-out fill-mode-backwards">

          {/* ================= HERO ================= */}
          <section className="flex flex-col gap-8 sm:gap-10 tracking-normal">
            {/* Identity row */}
            <div className="flex items-center gap-4">
              <div className="shrink-0 relative">
                <div className="absolute inset-0 rounded-full bg-primary/20 blur-xl animate-pulse" />
                <img
                  src="/SiteImages/roundImageHeader.svg"
                  alt="Akash"
                  className="relative rounded-full h-12 w-12 sm:h-16 sm:w-16 border-2 border-background shadow-lg"
                />
              </div>

              <div className="flex flex-col">
                <h1 className="text-3xl sm:text-5xl font-semibold tracking-tight text-foreground bg-gradient-to-br from-foreground to-muted-foreground/60 bg-clip-text text-transparent pb-1">
                  Akash
                </h1>
                <span className="text-base sm:text-lg text-muted-foreground font-light">
                  Design Engineer
                </span>
              </div>
            </div>

            <div className="space-y-6 max-w-3xl">
              <p className="text-2xl sm:text-3xl font-light text-foreground leading-snug">
                Designing with humans at the centre. <br className="hidden sm:block" />
                  Enter the <Link href="/craft" className="group font-normal text-foreground underline decoration-muted-foreground/30 underline-offset-4 transition-all hover:decoration-primary hover:text-primary relative inline-flex items-center gap-1">
                    craft
                    <svg className="h-5 w-5 opacity-0 -translate-x-2 transition-all group-hover:opacity-100 group-hover:translate-x-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 8l4 4m0 0l-4 4m4-4H3" />
                    </svg>
                  </Link> to explore the components.
                </p>

                    <p className="text-xl sm:text-2xl text-muted-foreground/80 font-light leading-relaxed w-full">
                      I build systems that balance ambition with pragmatism. My work spans reusable foundations that scale, intelligent visual experiences that adapt, and cloud-native reliability that endures.
                    </p>

                <div className="flex items-center gap-6 pt-4">
                  <Link href="mailto:ezdecode@gmail.com" className="group flex items-center gap-2 text-sm font-normal text-foreground/80 transition-colors hover:text-foreground">
                    <span className="border-b border-muted-foreground/30 pb-0.5 transition-colors group-hover:border-foreground">Get in touch</span>
                  </Link>
                </div>
              </div>
            </section>

            {/* ================= FEATURED CRAFT ================= */}
            {featuredComponents.length > 0 && (
              <section className="flex flex-col gap-6 animate-in fade-in slide-in-from-bottom-8 duration-1000 delay-200">
                <div className="flex items-center justify-between border-b border-border/10 pb-4">
                  <h2 className="text-sm font-normal text-muted-foreground uppercase tracking-widest">Featured Experiments</h2>
                  <Link href="/craft" className="text-sm text-foreground/60 hover:text-foreground transition-colors flex items-center gap-1 group">
                    View all
                    <svg className="w-3 h-3 transition-transform group-hover:translate-x-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                    </svg>
                  </Link>
                </div>

                <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                  {featuredComponents.map((component) => (
                    <Link
                      key={component.id}
                      href={`/craft/${component.id}`}
                      className="group relative flex flex-col justify-between overflow-hidden rounded-xl border border-border/40 bg-zinc-50/50 dark:bg-zinc-900/20 p-6 transition-all hover:bg-muted/40 hover:border-border/80 hover:shadow-lg hover:-translate-y-1"
                    >
                      <div className="flex flex-col gap-3">
                        <h3 className="text-lg font-medium text-foreground">
                          {component.title}
                        </h3>
                        {component.description && (
                          <p className="text-[15px] text-muted-foreground/80 line-clamp-2 leading-relaxed">
                            {component.description}
                          </p>
                        )}
                      </div>
                      <div className="mt-4 flex items-center justify-end opacity-0 transition-all group-hover:opacity-100">
                        <span className="text-xs font-normal text-primary flex items-center gap-1">
                          Explore
                          <svg className="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14 5l7 7m0 0l-7 7m7-7H3" />
                          </svg>
                        </span>
                      </div>
                    </Link>
                  ))}
                </div>
              </section>
            )}


          <Footer />
        </div>
      </div>
    </main>
  );
}


--- src/components/ClientProviders.tsx ---

"use client";

import { useEffect, useState } from "react";

export function ClientProviders({ children }: { children: React.ReactNode }) {
  const [mounted, setMounted] = useState(false);

  useEffect(() => {
    setMounted(true);
  }, []);

  return <>{children}</>;
}


--- src/components/ErrorBoundary.tsx ---

"use client";

import React, { Component, ErrorInfo, ReactNode } from "react";
import { Icon } from "@iconify/react";

interface ErrorBoundaryProps {
    children: ReactNode;
    /** Optional fallback UI to render on error */
    fallback?: ReactNode;
    /** Optional callback when error is caught */
    onError?: (error: Error, errorInfo: ErrorInfo) => void;
    /** Component name for better error identification */
    componentName?: string;
}

interface ErrorBoundaryState {
    hasError: boolean;
    error: Error | null;
    errorInfo: ErrorInfo | null;
}

/**
 * ErrorBoundary
 * 
 * Catches JavaScript errors anywhere in child component tree,
 * logs those errors, and displays a fallback UI.
 * 
 * Features:
 * - Graceful error handling without crashing the entire page
 * - Retry button to attempt recovery
 * - Optional Sentry integration (if NEXT_PUBLIC_SENTRY_DSN is set)
 * - Customizable fallback UI
 */
export class ErrorBoundary extends Component<ErrorBoundaryProps, ErrorBoundaryState> {
    constructor(props: ErrorBoundaryProps) {
        super(props);
        this.state = { hasError: false, error: null, errorInfo: null };
    }

    static getDerivedStateFromError(error: Error): Partial<ErrorBoundaryState> {
        return { hasError: true, error };
    }

    componentDidCatch(error: Error, errorInfo: ErrorInfo) {
        this.setState({ errorInfo });

        // Log to console
        console.error(
            `[ErrorBoundary] Error in ${this.props.componentName || 'component'}:`,
            error,
            errorInfo
        );

        // Call optional error handler
        if (this.props.onError) {
            this.props.onError(error, errorInfo);
        }

        // Send to Sentry if configured
        if (typeof window !== 'undefined' && (window as any).Sentry) {
            (window as any).Sentry.captureException(error, {
                extra: {
                    componentStack: errorInfo.componentStack,
                    componentName: this.props.componentName,
                },
            });
        }
    }

    handleRetry = () => {
        this.setState({ hasError: false, error: null, errorInfo: null });
    };

    render() {
        if (this.state.hasError) {
            // Custom fallback if provided
            if (this.props.fallback) {
                return this.props.fallback;
            }

            // Default fallback UI
            return (
                <div className="flex flex-col items-center justify-center min-h-[200px] p-6 bg-muted/30 rounded-xl border border-border/10">
                    <div className="flex flex-col items-center gap-4 text-center max-w-md">
                        {/* Error Icon */}
                        <div className="p-3 rounded-full bg-red-500/10 text-red-500">
                            <Icon icon="solar:danger-triangle-bold" className="w-6 h-6" />
                        </div>

                        {/* Error Message */}
                        <div className="space-y-1">
                            <h3 className="text-sm font-medium text-foreground">
                                Something went wrong
                            </h3>
                            <p className="text-xs text-muted-foreground">
                                {this.props.componentName
                                    ? `Failed to render ${this.props.componentName}`
                                    : "This component encountered an error"}
                            </p>
                        </div>

                        {/* Error Details (dev only) */}
                        {process.env.NODE_ENV === "development" && this.state.error && (
                            <details className="w-full text-left">
                                <summary className="text-xs text-muted-foreground cursor-pointer hover:text-foreground">
                                    Show error details
                                </summary>
                                <pre className="mt-2 p-3 bg-zinc-950 text-red-400 text-xs rounded-lg overflow-auto max-h-32">
                                    {this.state.error.message}
                                    {this.state.errorInfo?.componentStack}
                                </pre>
                            </details>
                        )}

                        {/* Retry Button */}
                        <button
                            onClick={this.handleRetry}
                            className="mt-2 px-4 py-2 text-xs font-medium bg-muted hover:bg-muted/80 text-foreground rounded-lg transition-colors flex items-center gap-2"
                        >
                            <Icon icon="solar:restart-bold" className="w-3.5 h-3.5" />
                            Try again
                        </button>
                    </div>
                </div>
            );
        }

        return this.props.children;
    }
}

/**
 * withErrorBoundary HOC
 * 
 * Wraps a component with an ErrorBoundary for easier usage.
 */
export function withErrorBoundary<P extends object>(
    WrappedComponent: React.ComponentType<P>,
    componentName?: string
): React.FC<P> {
    const displayName = componentName || WrappedComponent.displayName || WrappedComponent.name || 'Component';

    const WithErrorBoundary: React.FC<P> = (props) => (
        <ErrorBoundary componentName={displayName}>
            <WrappedComponent {...props} />
        </ErrorBoundary>
    );

    WithErrorBoundary.displayName = `WithErrorBoundary(${displayName})`;
    return WithErrorBoundary;
}


--- src/components/code/CodeBlock.tsx ---

"use client";

import * as React from "react";
import { Icon } from "@iconify/react";
import Prism from "prismjs";

import "prismjs/components/prism-javascript";
import "prismjs/components/prism-jsx";
import "prismjs/components/prism-typescript";
import "prismjs/components/prism-tsx";
import "prismjs/components/prism-bash";

import "./prism-theme.css";
import "./code-scrollbar.css";

import { Button } from "@/components/ui/button";
import { cn } from "@/lib/utils";

interface CodeBlockProps {
  code: string;
  language?: "js" | "jsx" | "ts" | "tsx" | "bash";
  filename?: string;
  showBorder?: boolean;
  className?: string;
}

export function CodeBlock({
  code,
  language = "tsx",
  filename,
  showBorder = false,
  className,
}: CodeBlockProps) {
  const [copied, setCopied] = React.useState(false);
  const codeRef = React.useRef<HTMLElement>(null);

  // Prism runs ONLY after hydration
  React.useEffect(() => {
    if (!codeRef.current) return;
    Prism.highlightElement(codeRef.current);
  }, [code, language]);

  const copyToClipboard = async () => {
    try {
      if (typeof navigator !== "undefined" && navigator.clipboard) {
        await navigator.clipboard.writeText(code);
        setCopied(true);
        setTimeout(() => setCopied(false), 2000);
      } else {
        // Fallback for non-secure contexts or unsupported browsers
        const textArea = document.createElement("textarea");
        textArea.value = code;
        document.body.appendChild(textArea);
        textArea.select();
        try {
          document.execCommand("copy");
          setCopied(true);
          setTimeout(() => setCopied(false), 2000);
        } catch (err) {
          console.error("Fallback: Oops, unable to copy", err);
        }
        document.body.removeChild(textArea);
      }
    } catch (err) {
      console.error("Failed to copy text: ", err);
    }
  };

  return (
    <div
      className={cn(
        "relative overflow-hidden rounded-xl group border border-border/10 bg-zinc-800 dark:bg-zinc-800 shadow-sm ring-1 ring-border/5",
        className
      )}
    >
      {/* Code viewport */}
      <div className="relative max-h-[520px] overflow-auto code-scrollbar">
        <Button
          size="icon"
          variant="ghost"
          onClick={copyToClipboard}
          className="absolute right-4 top-4 z-20 h-8 w-8 text-muted-foreground/50 hover:bg-foreground/10 hover:text-foreground opacity-0 group-hover:opacity-100 transition-all duration-200"
        >
          {copied ? (
            <Icon icon="solar:check-circle-linear" className="h-4 w-4 text-green-500" />
          ) : (
            <Icon icon="solar:copy-linear" className="h-4 w-4" />
          )}
          <span className="sr-only">Copy code</span>
        </Button>

        {filename && (
          <div className="absolute left-4 top-3 z-20">
            <span className="text-[10px] font-mono uppercase tracking-widest text-muted-foreground/40">
              {filename}
            </span>
          </div>
        )}

        <pre
          // These attributes MUST exist on first render
          tabIndex={0}
          className={cn(
            "p-5 text-[12px] font-mono leading-relaxed",
            `language-${language}`,
            filename && "pt-10"
          )}
        >
          <code
            ref={codeRef}
            className={`language-${language}`}
          >
            {code}
          </code>
        </pre>
      </div>
    </div>
  );
}


--- src/components/code/code-scrollbar.css ---

/* File: src/components/code/code-scrollbar.css */

/* Scoped scrollbar for code viewing surfaces */
.code-scrollbar {
  scrollbar-width: thin; /* Firefox */
  scrollbar-color: rgba(120, 120, 120, 0.3) transparent;
}

/* WebKit-based browsers */
.code-scrollbar::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

.code-scrollbar::-webkit-scrollbar-track {
  background: transparent;
}

.code-scrollbar::-webkit-scrollbar-thumb {
  background-color: rgba(120, 120, 120, 0.35);
  border-radius: 8px;
  border: 2px solid transparent;
  background-clip: padding-box;
  transition: background-color 0.2s ease;
}

.code-scrollbar::-webkit-scrollbar-thumb:hover {
  background-color: rgba(160, 160, 160, 0.5);
}

/* Fully hide native arrow buttons */
.code-scrollbar::-webkit-scrollbar-button {
  display: none;
  width: 0;
  height: 0;
}


--- src/components/code/prism-theme.css ---

/* Prism.js Dark Theme - Fixed Colors for Dark Background */

code[class*="language-"],
pre[class*="language-"] {
  color: #e4e4e7; /* zinc-200 */
  text-shadow: none;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  direction: ltr;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  line-height: 1.6;
  tab-size: 2;
  hyphens: none;
}

/* Tokens */
.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
  color: #71717a; /* zinc-500 */
  font-style: italic;
}

.token.punctuation {
  color: #a1a1aa; /* zinc-400 */
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
  color: #7dd3fc; /* sky-300 */
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
  color: #86efac; /* green-300 */
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
  color: #67e8f9; /* cyan-300 */
}

.token.atrule,
.token.attr-value,
.token.keyword {
  color: #c084fc; /* purple-400 */
}

.token.function,
.token.class-name {
  color: #fde047; /* yellow-300 */
}

.token.regex,
.token.important,
.token.variable {
  color: #fdba74; /* orange-300 */
}

.token.important,
.token.bold {
  font-weight: 600;
}

.token.italic {
  font-style: italic;
}

.token.entity {
  cursor: help;
}


--- src/components/craft/CodePanel.tsx ---

"use client";

import * as React from "react";
import { Icon } from "@iconify/react";
import { motion } from "framer-motion";
import { cn } from "@/lib/utils";
import Prism from "prismjs";

import "prismjs/components/prism-javascript";
import "prismjs/components/prism-jsx";
import "prismjs/components/prism-typescript";
import "prismjs/components/prism-tsx";
import "prismjs/components/prism-bash";

import "@/components/code/prism-theme.css";
import "@/components/code/code-scrollbar.css";

interface CodePanelProps {
    componentName: string;
    className?: string;
}

function toPascalCase(str: string): string {
    return str
        .split("-")
        .map((w) => w.charAt(0).toUpperCase() + w.slice(1))
        .join("");
}

export function CodePanel({ componentName, className }: CodePanelProps) {
    const [componentCode, setComponentCode] = React.useState<string | null>(null);
    const [loading, setLoading] = React.useState(true);
    const [error, setError] = React.useState<string | null>(null);
    const [copied, setCopied] = React.useState(false);

    const filename = `${toPascalCase(componentName)}.tsx`;

    React.useEffect(() => {
        const fetchCode = async () => {
            setLoading(true);
            setError(null);
            try {
                const res = await fetch(`/api/source?type=component&name=${componentName}`);
                if (res.ok) {
                    const data = await res.json();
                    setComponentCode(data.code);
                } else {
                    throw new Error("Failed to fetch component code");
                }
            } catch (err) {
                setError(err instanceof Error ? err.message : "Unknown error");
            } finally {
                setLoading(false);
            }
        };
        fetchCode();
    }, [componentName]);

    const handleCopy = async () => {
        if (!componentCode) return;
        try {
            await navigator.clipboard.writeText(componentCode);
            setCopied(true);
            setTimeout(() => setCopied(false), 2000);
        } catch (err) {
            console.error("Failed to copy:", err);
        }
    };

    return (
        <motion.div
            initial={{ opacity: 0, y: -20 }}
            animate={{ opacity: 1, y: 0, transition: { type: "tween", ease: "easeIn", duration: 0.2 } }}
            exit={{ opacity: 0, y: -20, transition: { type: "tween", ease: "easeOut", duration: 0.2 } }}
            className={cn(
                "relative w-full h-full overflow-hidden bg-zinc-800 rounded-xl border border-border/10",
                className
            )}
        >
            {/* Filename + Copy at top right */}
            <div className="absolute top-4 right-4 z-10 flex items-center gap-3">
                <span className="text-sm text-muted-foreground font-mono">
                    {filename}
                </span>
                <button
                    onClick={handleCopy}
                    className={cn(
                        "flex items-center justify-center size-8 rounded-lg transition-all",
                        copied
                            ? "bg-green-500/20 text-green-400"
                            : "text-muted-foreground hover:text-foreground"
                    )}
                >
                    <Icon icon={copied ? "lucide:check" : "lucide:copy"} className="size-4" />
                </button>
            </div>

            {/* Code */}
            <div
                className="absolute inset-0 overflow-auto p-6 pt-14 scrollbar-hide"
                style={{
                    scrollbarWidth: "none",
                    msOverflowStyle: "none",
                }}
            >
                <style jsx global>{`
                    .scrollbar-hide::-webkit-scrollbar {
                        display: none;
                    }
                `}</style>
                {loading ? (
                    <div className="flex items-center justify-center h-full">
                        <div className="flex items-center gap-3 text-muted-foreground">
                            <div className="size-5 animate-spin rounded-full border-2 border-primary border-t-transparent" />
                            <span>Loading code...</span>
                        </div>
                    </div>
                ) : error ? (
                    <div className="flex items-center justify-center h-full">
                        <p className="text-muted-foreground">{error}</p>
                    </div>
                ) : componentCode ? (
                    <pre
                        className="p-0 m-0 text-sm font-mono leading-relaxed bg-transparent"
                        tabIndex={0}
                    >
                        <code
                            ref={(el) => {
                                if (el) Prism.highlightElement(el);
                            }}
                            className="language-tsx"
                        >
                            {componentCode}
                        </code>
                    </pre>
                ) : (
                    <div className="flex items-center justify-center h-full">
                        <p className="text-muted-foreground">No code available.</p>
                    </div>
                )}
            </div>
        </motion.div>
    );
}


--- src/components/craft/ComponentPreview.tsx ---

"use client";

import * as React from "react";
import { resolveComponent, getAllComponentsMetadata } from "@/lib/registry/resolver";
import { PreviewDock } from "./PreviewDock";
import { CraftNavDrawer } from "./CraftNavDrawer";
import { useCodePanel } from "@/app/craft/[slug]/CraftPageWrapper";
import { ErrorBoundary } from "@/components/ErrorBoundary";
import { cn } from "@/lib/utils";
import { Icon } from "@iconify/react";
import { motion, AnimatePresence } from "framer-motion";

interface ComponentPreviewProps {
  name: string;
  className?: string;
}

/**
 * ComponentPreview - Universal Component Renderer
 */
export function ComponentPreview({
  name,
  className,
}: ComponentPreviewProps) {
  const [Component, setComponent] = React.useState<React.ComponentType<any> | null>(null);
  const [metadata, setMetadata] = React.useState<any>(null);
  const [error, setError] = React.useState<string | null>(null);
  const [isLoading, setIsLoading] = React.useState(true);
  const [retryCount, setRetryCount] = React.useState(0);
  const [isFullscreen, setIsFullscreen] = React.useState(false);
  const [isDrawerOpen, setIsDrawerOpen] = React.useState(false);

  // Use context for code panel state (the overlay appears on the docs section)
  const { showCode, toggleCode } = useCodePanel();

  const scrollContainerRef = React.useRef<HTMLDivElement | null>(null);
  const allComponents = React.useMemo(() => getAllComponentsMetadata(), []);

  // Load component
  React.useEffect(() => {
    let mounted = true;
    setIsLoading(true);
    setError(null);

    resolveComponent(name)
      .then((resolved) => {
        if (mounted) {
          setComponent(() => resolved.Component);
          setMetadata(resolved.metadata);
          setIsLoading(false);
        }
      })
      .catch((err) => {
        if (mounted) {
          setError(err.message || "Failed to load component");
          setIsLoading(false);
        }
      });

    return () => { mounted = false; };
  }, [name, retryCount]);

  // Close fullscreen on escape
  React.useEffect(() => {
    const handleKeyDown = (e: KeyboardEvent) => {
      if (e.key === "Escape" && isFullscreen) {
        setIsFullscreen(false);
      }
    };
    window.addEventListener("keydown", handleKeyDown);
    return () => window.removeEventListener("keydown", handleKeyDown);
  }, [isFullscreen]);

  const handleRetry = () => setRetryCount(c => c + 1);
  const toggleFullscreen = () => setIsFullscreen(prev => !prev);

  // Extract demo config
  const demo = metadata?.demo || {};
  const isScrollable = demo.scrollable === true;
  const minHeight = demo.minHeight;

  // Loading state
  if (isLoading) {
    return (
      <div
        className={cn(
          "w-full h-full flex items-center justify-center rounded-xl border border-border/10 bg-zinc-800",
          className
        )}
      >
        <div className="flex flex-col items-center gap-4">
          <div className="h-10 w-10 animate-spin border-4 border-zinc-800 border-t-primary rounded-full" />
          <p className="text-sm text-muted-foreground">Loading component...</p>
        </div>
      </div>
    );
  }

  // Error state
  if (error || !Component) {
    return (
      <div
        className={cn(
          "w-full h-full flex items-center justify-center rounded-xl border border-border/10 bg-zinc-800",
          className
        )}
      >
        <div className="flex flex-col items-center gap-4 text-center p-6">
          <div className="p-3 rounded-full bg-red-500/10 text-red-500">
            <Icon icon="solar:danger-triangle-bold" className="w-6 h-6" />
          </div>
          <div>
            <h3 className="text-sm font-medium text-foreground">Failed to load component</h3>
            <p className="text-xs text-muted-foreground mt-1 max-w-xs">{error}</p>
          </div>
          <button
            onClick={handleRetry}
            className="mt-2 px-4 py-2 text-xs font-normal bg-zinc-800 hover:bg-zinc-700 text-foreground rounded-lg transition-colors flex items-center gap-2"
          >
            <Icon icon="solar:restart-bold" className="w-3.5 h-3.5" />
            Retry
          </button>
        </div>
      </div>
    );
  }

  // Render content based on scrollable prop
  const renderContent = () => {
    const componentProps = {
      ...(demo.defaultProps || {}),
      ...(isScrollable ? { scrollContainerRef } : {}),
    };

    if (isScrollable) {
      return (
        <div
          ref={scrollContainerRef}
          className="absolute inset-0 overflow-y-auto overflow-x-hidden scrollbar-hide"
          style={{
            WebkitOverflowScrolling: "touch",
            scrollbarWidth: "none",
            msOverflowStyle: "none",
          }}
        >
          <ErrorBoundary componentName={name}>
            <Component {...componentProps} />
          </ErrorBoundary>
        </div>
      );
    }

    return (
      <div className="flex items-center justify-center w-full h-full">
        <ErrorBoundary componentName={name}>
          <Component {...componentProps} />
        </ErrorBoundary>
      </div>
    );
  };

  return (
    <>
      {/* Fullscreen Backdrop */}
      <AnimatePresence>
        {isFullscreen && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            transition={{ duration: 0.2 }}
            className="fixed inset-0 z-40 bg-background/80 backdrop-blur-xl"
            onClick={() => setIsFullscreen(false)}
          />
        )}
      </AnimatePresence>

      {/* Main Preview Container */}
      <motion.div
        layout
        transition={{ type: "spring", damping: 30, stiffness: 300 }}
        className={cn(
          "relative overflow-hidden bg-zinc-800",
          isFullscreen
            ? "fixed inset-3 z-50 rounded-2xl shadow-2xl border border-border/20"
            : "w-full h-full rounded-xl border border-border/10",
          !isFullscreen && className
        )}
        style={!isFullscreen && minHeight ? { minHeight } : undefined}
      >
        {/* Component Content */}
        {renderContent()}

        {/* Dock & Navigation */}
        <motion.div
          layout="position"
          className={cn(
            "absolute z-[100] right-4 lg:right-6",
            isFullscreen
              ? "bottom-4 lg:top-6 lg:bottom-auto"
              : "bottom-4 lg:top-6 lg:bottom-auto"
          )}
        >
          <CraftNavDrawer
            components={allComponents}
            open={isDrawerOpen}
            onOpenChange={setIsDrawerOpen}
            trigger={null}
          />

          <PreviewDock
            onFullscreen={toggleFullscreen}
            onShowCode={toggleCode}
            onOpenComponents={() => setIsDrawerOpen(true)}
            showCode={showCode}
            isFullscreen={isFullscreen}
          />
        </motion.div>
      </motion.div>
    </>
  );
}


--- src/components/craft/CopyCodeButton.tsx ---

"use client";

import React, { useState } from "react";
import { Icon } from "@iconify/react";
import { cn } from "@/lib/utils";

interface CopyCodeButtonProps {
  name: string;
}

export function CopyCodeButton({ name }: CopyCodeButtonProps) {
  const [copied, setCopied] = useState(false);
  const [loading, setLoading] = useState(false);

  const handleCopy = async () => {
    if (loading) return;
    setLoading(true);
    try {
      const response = await fetch(`/api/source?type=component&name=${name}`);
      const data = await response.json();
      
      if (data.code) {
        await navigator.clipboard.writeText(data.code);
        setCopied(true);
        setTimeout(() => setCopied(false), 2000);
      }
    } catch (err) {
      console.error("Failed to copy code:", err);
    } finally {
      setLoading(false);
    }
  };

  return (
    <button
      onClick={handleCopy}
      disabled={loading}
      className="group relative flex items-center gap-2.5 px-3.5 py-1.5 rounded-xl bg-foreground/[0.03] hover:bg-foreground/[0.06] active:bg-foreground/[0.08] transition-all duration-200 border border-foreground/5 hover:border-foreground/10 shadow-sm overflow-hidden"
      title="Copy component code"
    >
        <div className="relative size-4 flex items-center justify-center">
          <Icon 
            icon={loading ? "lucide:loader-2" : "lucide:copy"} 
            className={cn(
              "size-4 transition-all duration-300",
              loading ? "animate-spin opacity-100" : "opacity-70 group-hover:opacity-100",
              copied ? "scale-0 opacity-0" : "scale-100"
            )} 
          />
          <Icon 
            icon="lucide:check" 
            className={cn(
              "absolute inset-0 size-4 text-emerald-500 transition-all duration-300",
              copied ? "scale-100 opacity-100" : "scale-50 opacity-0"
            )} 
          />
        </div>
        <span className="text-[12px] font-semibold uppercase tracking-wider text-foreground/60 group-hover:text-foreground/80 transition-colors">
          {loading ? "Fetching..." : copied ? "Copied!" : "Copy Code"}
        </span>
    </button>
  );
}


--- src/components/craft/CraftNavDrawer.tsx ---

"use client";

import * as React from "react";
import Link from "next/link";
import { usePathname } from "next/navigation";
import { motion, AnimatePresence } from "framer-motion";
import { cn } from "@/lib/utils";
import { RegistryComponent } from "@/lib/types";
import { Icon } from "@iconify/react";

interface CraftNavDrawerProps {
    components: RegistryComponent[];
    trigger?: React.ReactNode;
    open?: boolean;
    onOpenChange?: (open: boolean) => void;
}

export function CraftNavDrawer({ components, trigger, open: externalOpen, onOpenChange }: CraftNavDrawerProps) {
    const pathname = usePathname();
    const [internalOpen, setInternalOpen] = React.useState(false);
    
    const isOpen = externalOpen !== undefined ? externalOpen : internalOpen;
    const setIsOpen = (value: boolean) => {
        if (onOpenChange) onOpenChange(value);
        setInternalOpen(value);
    };

    const containerRef = React.useRef<HTMLDivElement>(null);

    // Close on escape key
    React.useEffect(() => {
        const handleKeyDown = (e: KeyboardEvent) => {
            if (e.key === "Escape") setIsOpen(false);
        };
        window.addEventListener("keydown", handleKeyDown);
        return () => window.removeEventListener("keydown", handleKeyDown);
    }, []);

    // Close on route change
    React.useEffect(() => {
        setIsOpen(false);
    }, [pathname]);

    // Close on click outside
    React.useEffect(() => {
        const handleClickOutside = (event: MouseEvent) => {
            if (containerRef.current && !containerRef.current.contains(event.target as Node)) {
                setIsOpen(false);
            }
        };
        if (isOpen) {
            document.addEventListener("mousedown", handleClickOutside);
        }
        return () => document.removeEventListener("mousedown", handleClickOutside);
    }, [isOpen]);

    const sortedComponents = React.useMemo(
        () => [...components].sort((a, b) => a.title.localeCompare(b.title)),
        [components]
    );

    return (
        <div className="relative" ref={containerRef}>
            {/* Trigger Button */}
            {trigger !== null && (
                <div onClick={() => setIsOpen(!isOpen)} className="cursor-pointer">
                    {trigger || (
                        <button className="inline-flex items-center gap-2 px-3 py-1 rounded-full border border-border/10 bg-muted/50 text-muted-foreground hover:text-foreground hover:bg-muted transition-all">
                            <Icon icon="lucide:layout-grid" className="w-4 h-4" />
                            <span className="text-sm font-medium">Explore Components</span>
                        </button>
                    )}
                </div>
            )}

            {/* Expanded Menu */}
            <AnimatePresence>
                {isOpen && (
                    <>
                        {/* Backdrop - ultra subtle */}
                        <motion.div
                            initial={{ opacity: 0 }}
                            animate={{ opacity: 1 }}
                            exit={{ opacity: 0 }}
                            className="fixed inset-0 z-40 bg-background/5 lg:hidden"
                            onClick={() => setIsOpen(false)}
                        />

                        <motion.div
                            initial={{ 
                                opacity: 0, 
                                scale: 0.7, 
                                y: -10,
                                transformOrigin: "top left" 
                            }}
                            animate={{ 
                                opacity: 1, 
                                scale: 1, 
                                y: 8,
                            }}
                            exit={{ 
                                opacity: 0, 
                                scale: 0.85, 
                                y: -5,
                                transition: { duration: 0.2, ease: "circIn" }
                            }}
                            transition={{ 
                                type: "spring", 
                                damping: 12, // More rubbery
                                stiffness: 220, 
                                mass: 0.7
                            }}
                            className="absolute left-0 top-full z-50 min-w-[200px] w-max max-w-[calc(100vw-2rem)] bg-background/95 backdrop-blur-2xl border border-border/40 rounded-xl shadow-[0_30px_60px_-15px_rgba(0,0,0,0.25)] dark:shadow-[0_30px_60px_-15px_rgba(0,0,0,0.5)] overflow-hidden flex flex-col origin-top-left"
                        >
                            <div className="flex-1 overflow-y-auto p-2 scrollbar-none">
                                <motion.div 
                                    initial="hidden"
                                    animate="show"
                                    variants={{
                                        hidden: { opacity: 0 },
                                        show: {
                                            opacity: 1,
                                            transition: {
                                                staggerChildren: 0.04
                                            }
                                        }
                                    }}
                                    className="flex flex-col gap-0.5"
                                >

                                    {sortedComponents.map((component) => {
                                        const isActive = pathname === `/craft/${component.id}`;
                                        return (
                                            <motion.div 
                                                key={component.id}
                                                variants={{ 
                                                    hidden: { opacity: 0, x: -8, scale: 0.95 }, 
                                                    show: { opacity: 1, x: 0, scale: 1 } 
                                                }}
                                            >
                                                <Link
                                                    href={`/craft/${component.id}`}
                                                    className={cn(
                                                        "flex items-center px-3 py-2 rounded-lg text-[12px] font-medium transition-all group whitespace-nowrap",
                                                        isActive
                                                            ? "bg-foreground text-background"
                                                            : "text-muted-foreground hover:bg-muted/40 hover:text-foreground"
                                                    )}
                                                >
                                                    {component.title}
                                                </Link>
                                            </motion.div>
                                        );
                                    })}
                                </motion.div>
                            </div>
                        </motion.div>
                    </>
                )}
            </AnimatePresence>
        </div>
    );
}


--- src/components/craft/DemoContainer.tsx ---

"use client";

import * as React from "react";
import { cn } from "@/lib/utils";

interface DemoContainerProps extends React.HTMLAttributes<HTMLDivElement> {
  children: React.ReactNode;
  scrollable?: boolean;
  minHeight?: string;
  onScrollContainerRef?: (ref: HTMLDivElement | null) => void;
  isFullscreen?: boolean;
}

export function DemoContainer({
  children,
  scrollable = false,
  minHeight,
  onScrollContainerRef,
  className,
  isFullscreen = false,
  ...props
}: DemoContainerProps) {
  const scrollRef = React.useRef<HTMLDivElement>(null);

  React.useEffect(() => {
    if (onScrollContainerRef) {
      onScrollContainerRef(scrollRef.current);
    }
    return () => {
      if (onScrollContainerRef) {
        onScrollContainerRef(null);
      }
    };
  }, [onScrollContainerRef]);

  const baseStyles = cn(
    "relative w-full h-full overflow-hidden bg-zinc-800",
    !isFullscreen && "rounded-xl border border-border/10 shadow-2xl ring-1 ring-border/10",
    className
  );

  if (scrollable) {
    return (
      <div className={baseStyles} style={{ minHeight }} {...props}>
        <div
          ref={scrollRef}
          className="absolute inset-0 overflow-y-auto overflow-x-hidden scrollbar-hide"
          style={{
            WebkitOverflowScrolling: "touch",
            scrollbarWidth: "none",
            msOverflowStyle: "none",
          }}
        >
          {children}
        </div>
      </div>
    );
  }

  return (
    <div
      className={cn(baseStyles, "flex items-center justify-center")}
      style={{ minHeight }}
      {...props}
    >
      {children}
    </div>
  );
}


--- src/components/craft/PreviewDock.tsx ---

"use client";

import * as React from "react";
import { Icon } from "@iconify/react";
import { cn } from "@/lib/utils";
import { motion } from "framer-motion";

interface PreviewDockProps {
  onFullscreen?: () => void;
  onShowCode?: () => void;
  onOpenComponents?: () => void;
  onCommand?: () => void;
  showCode?: boolean;
  isFullscreen?: boolean;
  className?: string;
}

export function PreviewDock({
  onFullscreen,
  onShowCode,
  onOpenComponents,
  onCommand,
  showCode = false,
  isFullscreen = false,
  className,
}: PreviewDockProps) {
  return (
    <motion.section
      layout
      className={cn(
        "flex items-center gap-1 p-1.5 rounded-2xl",
        "bg-zinc-900/80 backdrop-blur-md",
        "border border-white/5",
        "shadow-2xl shadow-black/40",
        className
      )}
    >
      <DockItem
        onClick={onFullscreen}
        icon={isFullscreen ? "lucide:minimize" : "lucide:maximize"}
        label={isFullscreen ? "Minimize" : "Maximize"}
        isActive={isFullscreen}
      />

      <div className="w-px h-4 bg-white/5 mx-0.5" />

      <DockItem
        onClick={onOpenComponents}
        icon="lucide:circle-arrow-out-up-right"
        label="Components"
      />

      <DockItem
        onClick={onShowCode}
        icon="lucide:code-xml"
        label="Code"
        isActive={showCode}
      />

      <DockItem
        onClick={onCommand}
        icon="lucide:command"
        label="Cmd+K"
        className="hidden sm:flex"
      />
    </motion.section>
  );
}

interface DockItemProps {
  icon: string;
  label: string;
  onClick?: () => void;
  isActive?: boolean;
  className?: string;
}

function DockItem({ icon, label, onClick, isActive, className }: DockItemProps) {
  return (
    <button
      type="button"
      onClick={onClick}
      className={cn(
        "group relative flex items-center justify-center size-9 rounded-xl transition-all duration-200",
        "text-zinc-400 hover:text-zinc-100",
        "hover:bg-zinc-800/50",
        isActive && "bg-zinc-800 text-zinc-50 shadow-inner",
        className
      )}
    >
      <Icon
        icon={icon}
        className="size-[18px] transition-transform duration-200 group-hover:scale-110 group-active:scale-95"
      />
      <span className="sr-only">{label}</span>

      {/* Subtle active indicator */}
      {isActive && (
        <span className="absolute -bottom-1 left-1/2 -translate-x-1/2 w-0.5 h-0.5 bg-zinc-400 rounded-full" />
      )}
    </button>
  );
}


--- src/components/demos/adaptive-tooltip/AdaptiveTooltipDemo.tsx ---

"use client";

import { Icon } from "@iconify/react";
import { AdaptiveTooltip } from "@/content/adaptive-tooltip/AdaptiveTooltip";

export default function AdaptiveTooltipDemo() {
  return (
    <div className="w-full min-h-80 flex items-center justify-center">
      {/* Toolbar surface */}
        <AdaptiveTooltip
          enablePinning
          items={[
            {
              icon: (
                <div className="rounded-xl bg-neutral-800 p-2.5 text-neutral-100 transition-transform ">
                  <Icon icon="solar:user-circle-linear" width={26} />
                </div>
              ),
              label: "Profile",
            },
            {
              icon: (
                <div className="rounded-xl bg-neutral-800 p-2.5 text-neutral-100 transition-transform ">
                  <Icon icon="solar:chat-round-dots-linear" width={26} />
                </div>
              ),
              label: "Messages",
              hasBadge: true,
            },
            {
              icon: (
                <div className="rounded-xl bg-neutral-800 p-2.5 text-neutral-100 transition-transform ">
                  <Icon icon="solar:calendar-linear" width={26} />
                </div>
              ),
              label: "Schedule",
            },
            {
              icon: (
                <div className="rounded-xl bg-neutral-800 p-2.5 text-neutral-100 transition-transform ">
                  <Icon icon="solar:settings-linear" width={26} />
                </div>
              ),
              label: "Preferences",
            },
          ]}
        />
    </div>
  );
}


--- src/components/demos/filter-chips/FilterChipsDemo.tsx ---

"use client";

import React, { useState } from "react";
import { FilterChips } from "@/content/filter-chips/FilterChips";

const FILTERS = ["All", "Premium", "Experimental", "Buy Pro"] as const;

const FilterChipsDemo: React.FC = () => {
    const [active, setActive] = useState<string>("All");

    return (
        <div className="flex flex-col gap-8 w-full max-w-xl mx-auto p-6">
            {/* Default */}
            <section className="flex flex-col gap-3">
                <FilterChips
                    filters={FILTERS}
                    activeFilter={active}
                    onFilterChange={setActive}
                />
            </section>
        </div>
    );
};

export default FilterChipsDemo;


--- src/components/demos/magnetic-button/MagneticButtonDemo.tsx ---

"use client";

import React from 'react';
import MagneticButton from "@/content/magnetic-button/MagneticButton";

const MagneticButtonDemo: React.FC = () => {
	return (
		<div className="flex w-full h-56 items-center justify-center">
			<MagneticButton
				onClick={() => console.log('Magnetic button clicked')}
				hoverVariant="custom"
				customColor="#fff" // you can apply any color here
				className="px-8 py-2 rounded-full text-white shadow-lg"
				style={{
                    border: '2px solid #fff', // update here the same color as customColor
					fontSize: '1rem',
					fontWeight: 600,
					transition: 'all 0.33s cubic-bezier(0.22, 1, 0.36, 1)'
				}}
			>
				Hover Me
			</MagneticButton>
		</div>
	);
};

export default MagneticButtonDemo;



--- src/components/demos/scroll-reveal-text/ScrollRevealTextDemo.tsx ---

"use client";

import React from 'react';
import { ScrollRevealTextFramer } from "@/content/scroll-reveal-text/ScrollRevealText";

/**
 * ScrollRevealTextDemo
 * 
 * Demonstrates the ScrollRevealText component within a scrollable frame.
 * Since the component uses scroll-locking, it's best viewed in a container 
 * that allows scrolling (like the DemoContainer).
 */

const ScrollRevealTextDemo: React.FC<{ scrollContainerRef?: React.RefObject<HTMLDivElement> }> = ({ scrollContainerRef }) => {
    return (
        <ScrollRevealTextFramer
            phrase="Meanwhile, beneath the surface of yesterday's dreams, a constellation of possibility whispered secrets to the patient minds who dared to listen. Every moment transforms into a doorway, every question becomes an invitation to discover what we never knew we were searching for."
            highlightWords={["transforms"]}
            primaryColor="#ff6b00"
            scrollContainerRef={scrollContainerRef}
        />
    );
};

export default ScrollRevealTextDemo;


--- src/components/layout/Footer.tsx ---

"use client";

import { useEffect, useState } from "react";
import Link from "next/link";

export function Footer() {
  const [time, setTime] = useState<string>("");

  useEffect(() => {
    const updateTime = () => {
      const now = new Date();
      const istTime = new Intl.DateTimeFormat("en-IN", {
        timeZone: "Asia/Kolkata",
        hour: "2-digit",
        minute: "2-digit",
        second: "2-digit",
        hour12: false,
      }).format(now);
      setTime(istTime);
    };

    updateTime();
    const interval = setInterval(updateTime, 1000);
    return () => clearInterval(interval);
  }, []);

  return (
    <footer className="w-full border-t border-border pt-8 pb-32 sm:pb-28 md:pt-10 md:pb-8 mt-16">
      <div className="flex flex-col items-center gap-5 sm:gap-6">
        {/* Contact Section */}
        <div className="flex flex-col items-center gap-1.5">
          <p className="text-xs sm:text-sm text-muted-foreground">
            Want to get in touch?
          </p>
          <Link
            href="mailto:ezdecode@gmail.com"
            className="text-sm sm:text-base font-medium text-foreground hover:text-foreground/70 transition-colors"
          >
            ezdecode@gmail.com
          </Link>
        </div>

        {/* Info Row - Responsive */}
        <div className="flex flex-col items-center gap-2 sm:flex-row sm:flex-wrap sm:justify-center sm:gap-x-3 sm:gap-y-1 text-xs text-muted-foreground">
          <div className="flex items-center gap-2">
            <span>Based in IND</span>
            <span className="text-muted-foreground/50">·</span>
            <span className="tabular-nums font-mono">{time || "00:00:00"}</span>
          </div>

          <span className="hidden sm:inline text-muted-foreground/50">·</span>

          <Link
            href="https://github.com/ezDecode"
            target="_blank"
            rel="noopener noreferrer"
            className="hover:text-foreground transition-colors"
          >
            @ezDecode
          </Link>

          <span className="hidden sm:inline text-muted-foreground/50">·</span>

          <span>© {new Date().getFullYear()}</span>
        </div>
      </div>
    </footer>
  );
}


--- src/components/mdx/Callout.tsx ---

import { cn } from "@/lib/utils";
import React from "react";

interface CalloutProps {
    icon?: string;
    title?: string;
    children?: React.ReactNode;
    type?: "default" | "info" | "warning" | "error" | "success";
    className?: string;
}

export function Callout({
    children,
    title,
    type = "default",
    className,
    ...props
}: CalloutProps) {
    return (
        <div
            className={cn(
                "my-6 flex flex-col gap-2 rounded-2xl border p-5 text-[14px] leading-relaxed transition-all shadow-glass backdrop-blur-[6px]",
                {
                    "border-foreground/10": type === "default",
                    "border-blue-500/20 bg-blue-500/5 text-blue-900 dark:text-blue-200": type === "info",
                    "border-amber-500/20 bg-amber-500/5 text-amber-900 dark:text-amber-200": type === "warning",
                    "border-red-500/20 bg-red-500/5 text-red-900 dark:text-red-200": type === "error",
                    "border-green-500/20 bg-green-500/5 text-green-900 dark:text-green-200": type === "success",
                },
                className
            )}
            {...props}
        >
            {title && (
                <div className="flex items-center gap-2.5 font-semibold tracking-tight text-foreground/90">
                    <div className={cn("rounded-lg p-1", {
                        "bg-foreground/5": type === "default",
                        "bg-blue-500/10": type === "info",
                        "bg-amber-500/10": type === "warning",
                        "bg-red-500/10": type === "error",
                        "bg-green-500/10": type === "success",
                    })}>
                        {type === "info" && <InfoIcon className="h-3.5 w-3.5" />}
                        {type === "warning" && <AlertTriangleIcon className="h-3.5 w-3.5" />}
                        {type === "error" && <AlertCircleIcon className="h-3.5 w-3.5" />}
                        {type === "success" && <CheckCircleIcon className="h-3.5 w-3.5" />}
                        {type === "default" && <InfoIcon className="h-3.5 w-3.5" />}
                    </div>
                    <span>{title}</span>
                </div>
            )}
            <div className={cn("overflow-hidden", title ? "text-foreground/70" : "text-foreground/80")}>
                {children}
            </div>
        </div>
    );
}

function InfoIcon(props: React.SVGProps<SVGSVGElement>) {
    return (
        <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            strokeWidth="2"
            strokeLinecap="round"
            strokeLinejoin="round"
            {...props}
        >
            <circle cx="12" cy="12" r="10" />
            <path d="M12 16v-4" />
            <path d="M12 8h.01" />
        </svg>
    )
}

function AlertTriangleIcon(props: React.SVGProps<SVGSVGElement>) {
    return (
        <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            strokeWidth="2"
            strokeLinecap="round"
            strokeLinejoin="round"
            {...props}
        >
            <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z" />
            <path d="M12 9v4" />
            <path d="M12 17h.01" />
        </svg>
    )
}

function AlertCircleIcon(props: React.SVGProps<SVGSVGElement>) {
    return (
        <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            strokeWidth="2"
            strokeLinecap="round"
            strokeLinejoin="round"
            {...props}
        >
            <circle cx="12" cy="12" r="10" />
            <line x1="12" x2="12" y1="8" y2="12" />
            <line x1="12" x2="12.01" y1="16" y2="16" />
        </svg>
    )
}

function CheckCircleIcon(props: React.SVGProps<SVGSVGElement>) {
    return (
        <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            strokeWidth="2"
            strokeLinecap="round"
            strokeLinejoin="round"
            {...props}
        >
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
            <polyline points="22 4 12 14.01 9 11.01" />
        </svg>
    )
}


--- src/components/mdx/PropsTable.tsx ---

"use client";

import { cn } from "@/lib/utils";
import React from "react";

interface PropDefinition {
  name: string;
  description: string;
}

interface PropsTableProps {
  props: PropDefinition[];
  className?: string;
}

/**
 * PropsTable - Component API Documentation
 * 
 * Renders a clean props table for component documentation.
 * 
 * Usage in MDX:
 * ```mdx
 * <PropsTable props={[
 *   { name: "phrase", description: "The text to reveal" },
 *   { name: "color", description: "Primary color" },
 * ]} />
 * ```
 */
export function PropsTable({ props, className }: PropsTableProps) {
  return (
    <div className={cn("my-8 w-full overflow-x-auto", className)}>
      <table className="w-full text-left border-collapse">
        <tbody className="divide-y-0">
          {props.map((prop) => (
            <tr key={prop.name} className="border-foreground/10 border-t last:border-b group">
              <td className="py-4 pr-4 align-top w-1/4 sm:w-1/3">
                <span className="inline-flex items-center gap-1.5 font-mono text-sm font-medium text-foreground bg-muted/60 px-2.5 py-1 rounded-md border border-border/10">
                  {prop.name}
                </span>
              </td>
              <td className="py-4 align-top">
                <p className="text-base text-muted-foreground leading-relaxed">
                  {prop.description}
                </p>
              </td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  );
}

/**
 * PropItem - Inline prop documentation
 * 
 * Usage: <PropItem name="color">Description here</PropItem>
 */
export function PropItem({
  name,
  children
}: {
  name: string;
  children: React.ReactNode;
}) {
  return (
    <div className="my-8 border-foreground/10 border-t last:border-b py-6 group">
      <div className="grid grid-cols-1 sm:grid-cols-[1fr_2fr] gap-4">
        <div className="flex flex-col gap-1">
          <span className="inline-flex items-center gap-1.5 font-mono text-sm font-medium text-foreground bg-muted/60 px-2.5 py-1 rounded-md border border-border/10 w-fit">
            {name}
          </span>
        </div>
        <div className="flex flex-col gap-2">
          <div className="text-base text-muted-foreground leading-relaxed">
            {children}
          </div>
        </div>
      </div>
    </div>
  );
}


--- src/components/mdx/Steps.tsx ---

import { cn } from "@/lib/utils";
import React from "react";

export function Steps({ children, className, ...props }: React.ComponentProps<"div">) {
    return (
        <div
            className={cn(
                "mb-12 ml-4 border-l border-zinc-200 pl-8 [counter-reset:step] dark:border-zinc-800",
                className
            )}
            {...props}
        >
            {children}
        </div>
    );
}

export function Step({ title, children, className, ...props }: React.ComponentProps<"div"> & { title?: string }) {
    return (
        <div className={cn("relative pb-8 last:pb-0", className)} {...props}>
            <div className="absolute -left-[41px] top-1 flex h-7 w-7 items-center justify-center rounded-full bg-zinc-100 text-[13px] font-semibold text-zinc-900 ring-8 ring-background dark:bg-zinc-800 dark:text-zinc-50">
                <span className="before:content-[counter(step)] [counter-increment:step] flex items-center justify-center" />
            </div>
            {title && <h3 className="mb-2 text-lg font-medium tracking-tight text-foreground">{title}</h3>}
            <div className="text-muted-foreground text-[15px] leading-relaxed prose-code:bg-muted/50 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-foreground">
                {children}
            </div>
        </div>
    );
}


--- src/components/ui/button.tsx ---

import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
  {
    variants: {
        variant: {
          default:
            "bg-background text-foreground shadow-xs border border-border/20 hover:bg-accent hover:text-foreground",
          destructive:
            "bg-destructive text-destructive-foreground shadow-xs hover:bg-destructive/90",
          outline:
            "border border-border/20 bg-background shadow-xs hover:bg-accent hover:text-foreground",
          secondary:
            "bg-secondary text-secondary-foreground shadow-xs hover:bg-accent",
          ghost:
            "hover:bg-accent hover:text-foreground",
          link: "text-foreground underline-offset-4 hover:underline",
        },
      size: {
        default: "h-9 px-4 py-2 has-[>svg]:px-3",
        sm: "h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",
        lg: "h-10 rounded-md px-6 has-[>svg]:px-4",
        icon: "size-9",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

function Button({
  className,
  variant,
  size,
  asChild = false,
  ...props
}: React.ComponentProps<"button"> &
  VariantProps<typeof buttonVariants> & {
    asChild?: boolean
  }) {
  const Comp = asChild ? Slot : "button"

  return (
    <Comp
      data-slot="button"
      className={cn(buttonVariants({ variant, size, className }))}
      {...props}
    />
  )
}

export { Button, buttonVariants }


--- src/components/ui/drawer.tsx ---

"use client";

import * as React from "react";
import { Drawer as VaulDrawer } from "vaul";
import { cn } from "@/lib/utils";

const Drawer = ({
    shouldScaleBackground = true,
    direction = "bottom",
    ...props
}: React.ComponentProps<typeof VaulDrawer.Root>) => (
    <VaulDrawer.Root
        direction={direction}
        shouldScaleBackground={shouldScaleBackground}
        {...props}
    />
);
Drawer.displayName = "Drawer";

const DrawerTrigger = VaulDrawer.Trigger;

const DrawerPortal = VaulDrawer.Portal;

const DrawerClose = VaulDrawer.Close;

const DrawerOverlay = React.forwardRef<
    React.ElementRef<typeof VaulDrawer.Overlay>,
    React.ComponentPropsWithoutRef<typeof VaulDrawer.Overlay>
>(({ className, ...props }, ref) => (
    <VaulDrawer.Overlay
        ref={ref}
        className={cn("fixed inset-0 z-50 bg-black/40 backdrop-blur-[2px]", className)}
        {...props}
    />
));
DrawerOverlay.displayName = VaulDrawer.Overlay.displayName;

const DrawerContent = React.forwardRef<
    React.ElementRef<typeof VaulDrawer.Content>,
    React.ComponentPropsWithoutRef<typeof VaulDrawer.Content>
>(({ className, children, ...props }, ref) => (
    <DrawerPortal>
        <DrawerOverlay />
        <VaulDrawer.Content
            ref={ref}
            className={cn(
                "fixed z-50 flex flex-col focus:outline-none",
                className
            )}
            {...props}
        >
            {children}
        </VaulDrawer.Content>
    </DrawerPortal>
));
DrawerContent.displayName = "DrawerContent";

const DrawerHeader = ({
    className,
    ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
    <div
        className={cn("grid gap-1.5 p-4 text-center sm:text-left", className)}
        {...props}
    />
);
DrawerHeader.displayName = "DrawerHeader";

const DrawerFooter = ({
    className,
    ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
    <div
        className={cn("mt-auto flex flex-col gap-2 p-4", className)}
        {...props}
    />
);
DrawerFooter.displayName = "DrawerFooter";

const DrawerTitle = React.forwardRef<
    React.ElementRef<typeof VaulDrawer.Title>,
    React.ComponentPropsWithoutRef<typeof VaulDrawer.Title>
>(({ className, ...props }, ref) => (
    <VaulDrawer.Title
        ref={ref}
        className={cn(
            "text-lg font-medium leading-none tracking-tight",
            className
        )}
        {...props}
    />
));
DrawerTitle.displayName = VaulDrawer.Title.displayName;

const DrawerDescription = React.forwardRef<
    React.ElementRef<typeof VaulDrawer.Description>,
    React.ComponentPropsWithoutRef<typeof VaulDrawer.Description>
>(({ className, ...props }, ref) => (
    <VaulDrawer.Description
        ref={ref}
        className={cn("text-sm text-muted-foreground", className)}
        {...props}
    />
));
DrawerDescription.displayName = VaulDrawer.Description.displayName;

export {
    Drawer,
    DrawerPortal,
    DrawerOverlay,
    DrawerTrigger,
    DrawerClose,
    DrawerContent,
    DrawerHeader,
    DrawerFooter,
    DrawerTitle,
    DrawerDescription,
};


--- src/components/ui/progressive-blur.tsx ---

import React from "react";
import { cn } from "@/lib/utils";

type ProgressiveBlurProps = {
  className?: string;
  position?: "top" | "bottom";
  height?: string;
  blurAmount?: string;
};

export const ProgressiveBlur = ({
  className,
  position = "top",
  height = "80px",
  blurAmount = "8px",
}: ProgressiveBlurProps) => {
  const isTop = position === "top";

  return (
    <div
      className={cn(
        "pointer-events-none fixed left-0 z-40 w-full select-none",
        isTop ? "top-0" : "bottom-0",
        className
      )}
      style={{
        height,
        background: `linear-gradient(${isTop ? "to bottom" : "to top"}, hsl(var(--background)), transparent)`,
        backdropFilter: `blur(${blurAmount})`,
        maskImage: `linear-gradient(${isTop ? "to bottom" : "to top"}, black, transparent)`,
        WebkitBackdropFilter: `blur(${blurAmount})`,
        WebkitMaskImage: `linear-gradient(${isTop ? "to bottom" : "to top"}, black, transparent)`,
      }}
    />
  );
};


--- src/content/adaptive-tooltip/AdaptiveTooltip.tsx ---

"use client";

import { useCallback, useEffect, useRef, useState } from "react";
import type { ReactNode } from "react";
import { motion, AnimatePresence, LayoutGroup } from "framer-motion";
import { animate, stagger } from "animejs";
import clsx from "clsx";

/* -------------------------------------------------------------------------- */
/* TYPES                                                                      */
/* -------------------------------------------------------------------------- */

export type AdaptiveTooltipItem = {
  icon: ReactNode;
  label: string;
  shortcut?: ReactNode[];
  hasBadge?: boolean;
};

export interface AdaptiveTooltipProps {
  items: AdaptiveTooltipItem[];
  enablePinning?: boolean;
  className?: string;
}

/* -------------------------------------------------------------------------- */
/* COMPONENT                                                                  */
/* -------------------------------------------------------------------------- */

/**
 * AdaptiveTooltip
 *
 * An intelligent tooltip system that adapts to user intent.
 * - Intent-aware delay based on confidence
 * - Keyboard pinning support
 * - Micro-reveal animation for content
 * - Shared layout animation between tooltips
 */
export function AdaptiveTooltip({
  items,
  enablePinning = true,
  className,
}: AdaptiveTooltipProps) {
  const [activeIndex, setActiveIndex] = useState<number | null>(null);
  const [confidence, setConfidence] = useState(0);
  const [pinned, setPinned] = useState(false);

  const iconRefs = useRef<(HTMLButtonElement | null)[]>([]);
  const contentRef = useRef<HTMLDivElement | null>(null);
  const intentTimeout = useRef<ReturnType<typeof setTimeout> | null>(null);
  const decayTimeout = useRef<ReturnType<typeof setTimeout> | null>(null);

  /* ---------------------------------------------------------------------- */
  /* INTENT + CONFIDENCE (INLINE, EDITABLE)                                  */
  /* ---------------------------------------------------------------------- */

  const intentDelay = 100 - confidence * 70; // tweakable

  const handleEnter = useCallback(
    (index: number) => {
      setConfidence((c) => Math.min(c + 0.3, 1));

      if (intentTimeout.current) clearTimeout(intentTimeout.current);
      intentTimeout.current = setTimeout(() => {
        setActiveIndex(index);
      }, Math.max(intentDelay, 0));

      if (decayTimeout.current) clearTimeout(decayTimeout.current);
      decayTimeout.current = setTimeout(() => setConfidence(0), 4000);
    },
    [intentDelay]
  );

  const handleLeave = useCallback(() => {
    if (intentTimeout.current) clearTimeout(intentTimeout.current);
    if (!pinned) setActiveIndex(null);
  }, [pinned]);

  /* ---------------------------------------------------------------------- */
  /* KEYBOARD PINNING                                                        */
  /* ---------------------------------------------------------------------- */

  useEffect(() => {
    if (!enablePinning) return;

    const onDown = (e: KeyboardEvent) => {
      if (e.metaKey || e.shiftKey) setPinned(true);
    };
    const onUp = () => setPinned(false);

    window.addEventListener("keydown", onDown);
    window.addEventListener("keyup", onUp);

    return () => {
      window.removeEventListener("keydown", onDown);
      window.removeEventListener("keyup", onUp);
    };
  }, [enablePinning]);

  /* ---------------------------------------------------------------------- */
  /* CONTENT MICRO-REVEAL (ANIME.JS)                                         */
  /* ---------------------------------------------------------------------- */

  useEffect(() => {
    if (!contentRef.current) return;

    const id = setTimeout(() => {
      animate(contentRef.current!.children, {
        opacity: [0, 1],
        translateY: [2, 0],
        delay: stagger(14),
        duration: 180,
        easing: "easeOutQuad",
      });
    }, 40);

    return () => clearTimeout(id);
  }, [activeIndex]);

  /* ---------------------------------------------------------------------- */

  return (
    <LayoutGroup id="adaptive-tooltip">
      <div className={clsx("relative flex gap-3", className)}>
        {items.map((item, index) => (
          <button
            key={index}
            ref={(el) => {
              iconRefs.current[index] = el;
            }}
            onMouseEnter={() => handleEnter(index)}
            onMouseLeave={handleLeave}
            className="relative grid h-10 w-10 place-items-center rounded-lg bg-neutral-900 text-neutral-100"
          >
            {item.icon}
            {item.hasBadge && (
              <span className="absolute right-1 top-1 h-2 w-2 rounded-full bg-red-500" />
            )}
          </button>
        ))}

        <AnimatePresence>
          {activeIndex !== null && (
            <motion.div
              layoutId="tooltip"
              initial={{ opacity: 0, y: 6 }}
              animate={{ opacity: 1, y: 0 }}
              exit={{ opacity: 0, y: 4 }}
              transition={{
                type: "spring",
                stiffness: 560,
                damping: 36,
                mass: 0.35,
              }}
              style={{
                left:
                  iconRefs.current[activeIndex]
                    ? iconRefs.current[activeIndex]!.offsetLeft +
                      iconRefs.current[activeIndex]!.offsetWidth / 2
                    : 0,
              }}
              className="absolute bottom-full z-50 mb-2 -translate-x-1/2"
            >
              <motion.div
                layout
                transition={{ duration: 0.12, ease: "easeOut" }}
                className="rounded-xl bg-neutral-800 px-4 py-3 text-sm text-neutral-100 shadow-2xl"
              >
                <div ref={contentRef} className="flex flex-col gap-1">
                  <span className="tooltip-item font-medium">
                    {items[activeIndex].label}
                  </span>

                  {items[activeIndex].shortcut && (
                    <div className="tooltip-item flex gap-1 text-xs text-neutral-400">
                      {items[activeIndex].shortcut!.map((k, i) => (
                        <kbd
                          key={i}
                          className="rounded bg-neutral-700 px-1.5 py-0.5"
                        >
                          {k}
                        </kbd>
                      ))}
                    </div>
                  )}

                  {pinned && (
                    <div className="tooltip-item pt-2 text-xs text-neutral-400">
                      Pinned via keyboard intent
                    </div>
                  )}
                </div>
              </motion.div>
            </motion.div>
          )}
        </AnimatePresence>
      </div>
    </LayoutGroup>
  );
}


--- src/content/adaptive-tooltip/index.mdx ---

---
name: "adaptive-tooltip"
title: "Adaptive Tooltip"
description: "Intelligent tooltip system that adapts to user intent with confidence-based delays and smooth animations."
category: "UI"
version: "1.0.0"
dependencies: ["framer-motion", "animejs", "clsx"]
source: "src/content/adaptive-tooltip/index.mdx"
---

## Installation

<Steps>
  <Step>
    Install the required dependencies:
    ```bash
    npm install framer-motion animejs clsx
    ```
  </Step>
  <Step>
    Copy the component code into your project.
  </Step>
</Steps>

## Usage

```tsx
import { AdaptiveTooltip } from '@/components/AdaptiveTooltip';

const items = [
  { icon: <Home />, label: "Home" },
  { icon: <Settings />, label: "Settings" }
];

export default function App() {
  return <AdaptiveTooltip items={items} />;
}
```

## Props

<PropsTable props={[
  { name: "items", description: "Array of tooltip items to display." },
  { name: "enablePinning", description: "Enable keyboard pinning functionality." }
]} />

### AdaptiveTooltipItem

<PropsTable props={[
  { name: "icon", description: "Icon element to display." },
  { name: "label", description: "Tooltip text label." },
  { name: "hasBadge", description: "Show a notification badge on the icon." }
]} />


--- src/content/filter-chips/FilterChips.tsx ---

"use client";

import React, { useCallback, useMemo } from "react";
import { motion, type Transition } from "framer-motion";

/* ─────────────────────────────────────────────────────────────────
   Types
───────────────────────────────────────────────────────────────── */

export interface FilterChip<T extends string = string> {
    value: T;
    label?: string;
    icon?: React.ReactNode;
    disabled?: boolean;
}

export interface FilterChipsProps<T extends string = string> {
    filters: readonly (T | FilterChip<T>)[];
    activeFilter: T;
    onFilterChange?: (filter: T) => void;
    baseHref?: string;
    queryParam?: string;
    allValue?: T;
    layoutId?: string;
    size?: "sm" | "md" | "lg";
    variant?: "default" | "outline" | "ghost" | "pill";
    activeColor?: "default" | "primary" | "custom";
    customActiveColor?: string;
    customActiveTextColor?: string;
    gap?: "sm" | "md" | "lg";
    animation?: { stiffness?: number; damping?: number };
    className?: string;
    chipClassName?: string;
    asLinks?: boolean;
}

/* ─────────────────────────────────────────────────────────────────
   Styles
───────────────────────────────────────────────────────────────── */

const cn = (...c: (string | undefined | false | null)[]) => c.filter(Boolean).join(" ");

const SIZE = { sm: "px-2.5 py-1 text-xs", md: "px-3 py-1.5 text-sm", lg: "px-4 py-2 text-base" };
const GAP = { sm: "gap-1", md: "gap-2", lg: "gap-3" };

const VARIANT = {
    default: { base: "rounded-lg", inactive: "bg-muted/40 hover:bg-muted/60", indicator: "rounded-lg" },
    outline: { base: "rounded-lg border", inactive: "border-border hover:border-foreground/30", indicator: "rounded-lg" },
    ghost: { base: "rounded-md", inactive: "hover:bg-muted/40", indicator: "rounded-md" },
    pill: { base: "rounded-full", inactive: "bg-muted/40 hover:bg-muted/60", indicator: "rounded-full" },
};

const COLOR = {
    default: { indicator: "bg-foreground", text: "text-background" },
    primary: { indicator: "bg-primary", text: "text-primary-foreground" },
    custom: { indicator: "", text: "" },
};

/* ─────────────────────────────────────────────────────────────────
   Component
───────────────────────────────────────────────────────────────── */

export function FilterChips<T extends string = string>({
    filters,
    activeFilter,
    onFilterChange,
    baseHref,
    queryParam = "type",
    allValue,
    layoutId = "activeFilterChip",
    size = "md",
    variant = "pill",
    activeColor = "default",
    customActiveColor,
    customActiveTextColor,
    gap = "md",
    animation = {},
    className,
    chipClassName,
    asLinks = false,
}: FilterChipsProps<T>) {
    const transition: Transition = useMemo(
        () => ({ type: "spring", stiffness: animation.stiffness ?? 500, damping: animation.damping ?? 35 }),
        [animation.stiffness, animation.damping]
    );

    const v = VARIANT[variant];
    const c = COLOR[activeColor];

    const getHref = useCallback(
        (val: T) => (!baseHref ? "#" : val === allValue ? baseHref : `${baseHref}?${queryParam}=${val}`),
        [baseHref, allValue, queryParam]
    );

    const handleClick = useCallback(
        (val: T, e: React.MouseEvent) => {
            if (!asLinks || !baseHref) e.preventDefault();
            onFilterChange?.(val);
        },
        [onFilterChange, asLinks, baseHref]
    );

    const renderChip = (filter: T | FilterChip<T>) => {
        const chip = typeof filter === "string" ? { value: filter, label: filter } : { ...filter, label: filter.label ?? filter.value };
        const isActive = chip.value === activeFilter;

        const commonProps = {
            className: cn(
                "relative inline-flex items-center gap-1.5 font-medium transition-colors",
                SIZE[size],
                v.base,
                isActive ? c.text : cn("text-muted-foreground hover:text-foreground", v.inactive),
                chip.disabled && "opacity-50 pointer-events-none",
                chipClassName
            ),
            onClick: (e: React.MouseEvent) => !chip.disabled && handleClick(chip.value as T, e),
            "aria-pressed": isActive,
        };

        const content = (
            <>
                {isActive && (
                    <motion.span
                        layoutId={layoutId}
                        className={cn("absolute inset-0", v.indicator, c.indicator)}
                        style={customActiveColor ? { background: customActiveColor } : undefined}
                        transition={transition}
                        initial={false}
                    />
                )}
                <span
                    className="relative z-10 inline-flex items-center gap-1.5"
                    style={isActive && customActiveTextColor ? { color: customActiveTextColor } : undefined}
                >
                    {chip.icon}
                    {chip.label}
                </span>
            </>
        );

        return asLinks && baseHref ? (
            <a key={chip.value} href={getHref(chip.value as T)} {...commonProps}>{content}</a>
        ) : (
            <button key={chip.value} type="button" {...commonProps}>{content}</button>
        );
    };

    return (
        <div className={cn("flex flex-wrap", GAP[gap], className)} role="group" aria-label="Filter options">
            {filters.map(renderChip)}
        </div>
    );
}

export default FilterChips;

--- src/content/filter-chips/index.mdx ---

---
name: "filter-chips"
title: "Filter Chips"
description: "Animated filter chips with smooth shared layout transitions and spring physics for selection feedback."
category: "UI"
version: "1.0.0"
dependencies: ["framer-motion"]
source: "src/content/filter-chips/index.mdx"
---

## Installation

<Steps>
  <Step title="Install dependencies">
    Install the required dependencies using your package manager:
    ```bash
    npm install framer-motion
    ```
  </Step>
  <Step title="Copy implementation">
    Copy the component code into your project.
  </Step>
</Steps>

## Usage

```tsx
import { FilterChips } from "@/components/FilterChips";
import { useState } from "react";

export default function Demo() {
  const [active, setActive] = useState("All");
  
  return (
    <FilterChips
      filters={["All", "Design", "Development"]}
      activeFilter={active}
      onFilterChange={setActive}
    />
  );
}
```

## Props

<PropsTable props={[
  { name: "filters", description: "Array of filter labels to display." },
  { name: "activeFilter", description: "The currently selected filter value." },
  { name: "onFilterChange", description: "Callback triggered when a new filter is selected." },
  { name: "variant", description: "The visual style of the chips." },
  { name: "activeColor", description: "Custom background color for the active chip." }
]} />


--- src/content/magnetic-button/MagneticButton.tsx ---

"use client";

import React, { useRef, useEffect } from 'react';
import { gsap } from 'gsap';

interface MagneticButtonProps {
	children: React.ReactNode;
	className?: string;
	onClick?: () => void;
	hoverVariant?: 'light' | 'dark' | 'custom';
	customColor?: string;
	style?: React.CSSProperties;
}

const MagneticButton: React.FC<MagneticButtonProps> = ({ 
	children, 
	className = '', 
	onClick,
	hoverVariant = 'light',
	customColor,
	style
}) => {
	const buttonRef = useRef<HTMLButtonElement>(null);
	const flairRef = useRef<HTMLSpanElement>(null);

	useEffect(() => {
		const button = buttonRef.current;
		const flair = flairRef.current;

		if (!button || !flair) return;

		const xSet = gsap.quickSetter(flair, "xPercent") as (v: number) => void;
		const ySet = gsap.quickSetter(flair, "yPercent") as (v: number) => void;

		const getXY = (e: MouseEvent) => {
			const { left, top, width, height } = button.getBoundingClientRect();
			const xTransformer = gsap.utils.pipe(
				gsap.utils.mapRange(0, width, 0, 100),
				gsap.utils.clamp(0, 100)
			);
			const yTransformer = gsap.utils.pipe(
				gsap.utils.mapRange(0, height, 0, 100),
				gsap.utils.clamp(0, 100)
			);
			return {
				x: xTransformer(e.clientX - left),
				y: yTransformer(e.clientY - top),
			};
		};

		const mouseEnter = (e: MouseEvent | Touch) => {
			const evt = e as MouseEvent;
			const { x, y } = getXY(evt as MouseEvent);
			xSet(x);
			ySet(y);
			gsap.to(flair, { scale: 1, duration: 0.4, ease: 'power2.out' });
		};

		const mouseLeave = (e: MouseEvent | TouchEvent | null) => {
			// For touchend there is no coordinates; just animate exit from current position
			let x = 50;
			let y = 50;
			if (e && 'clientX' in (e as MouseEvent)) {
				const coords = getXY(e as MouseEvent);
				x = coords.x;
				y = coords.y;
			}
			gsap.killTweensOf(flair);
			gsap.to(flair, {
				xPercent: x > 90 ? x + 20 : x < 10 ? x - 20 : x,
				yPercent: y > 90 ? y + 20 : y < 10 ? y - 20 : y,
				scale: 0,
				duration: 0.3,
				ease: 'power2.out',
			});
		};

		const mouseMove = (e: MouseEvent | Touch) => {
			const evt = e as MouseEvent;
			const { x, y } = getXY(evt as MouseEvent);
			gsap.to(flair, {
				xPercent: x,
				yPercent: y,
				duration: 0.25,
				ease: 'power2',
			});
		};

		// Touch handlers (map first touch to mouse handlers)
		const touchStart = (e: TouchEvent) => {
			if (!e.touches || e.touches.length === 0) return;
			const t = e.touches[0];
			mouseEnter(t as unknown as MouseEvent);
		};

		const touchMove = (e: TouchEvent) => {
			if (!e.touches || e.touches.length === 0) return;
			const t = e.touches[0];
			mouseMove(t as unknown as MouseEvent);
		};

		const touchEnd = () => {
			mouseLeave(null);
		};

		button.addEventListener('mouseenter', mouseEnter as EventListener);
		button.addEventListener('mouseleave', mouseLeave as EventListener);
		button.addEventListener('mousemove', mouseMove as EventListener);
		button.addEventListener('touchstart', touchStart as EventListener, { passive: true });
		button.addEventListener('touchmove', touchMove as EventListener, { passive: true });
		button.addEventListener('touchend', touchEnd as EventListener);

		return () => {
			button.removeEventListener('mouseenter', mouseEnter as EventListener);
			button.removeEventListener('mouseleave', mouseLeave as EventListener);
			button.removeEventListener('mousemove', mouseMove as EventListener);
			button.removeEventListener('touchstart', touchStart as EventListener);
			button.removeEventListener('touchmove', touchMove as EventListener);
			button.removeEventListener('touchend', touchEnd as EventListener);
		};
	}, []);

	const flairColor = customColor 
		? '' 
		: hoverVariant === 'light' ? 'bg-white' : 'bg-black';
  
	const textHoverColor = customColor 
		? 'group-hover:text-black' 
		: hoverVariant === 'light' ? 'group-hover:text-black' : 'group-hover:text-white';

	return (
		<button
			type="button"
			ref={buttonRef}
			className={`relative overflow-hidden group focus:outline-none focus:ring-2 focus:ring-offset-2 ${className}`}
			onClick={onClick}
			style={style}
			aria-label={typeof children === 'string' ? children : 'Magnetic button'}
		>
			<span
				ref={flairRef}
				className="absolute top-0 left-0 w-full h-full pointer-events-none transform scale-0"
				style={{ transformOrigin: '0 0' }}
			>
				<span 
					className={`absolute top-0 left-0 w-[170%] aspect-square rounded-full transform -translate-x-1/2 -translate-y-1/2 ${flairColor}`}
					style={customColor ? { backgroundColor: customColor } : {}}
				></span>
			</span>
			<span className={`relative z-10 transition-colors duration-150 ${textHoverColor}`}>
				{children}
			</span>
		</button>
	);
};

export default MagneticButton;



--- src/content/magnetic-button/index.mdx ---

---
name: "magnetic-button"
title: "Magnetic Button"
description: "Cursor-following button with magnetic attraction, GSAP-powered flair animation, and smooth physics."
category: "UI"
version: "1.0.0"
dependencies: ["gsap"]
source: "src/content/magnetic-button/index.mdx"
---

## Installation

<Steps>
  <Step>
    Install the required dependencies:
    ```bash
    npm install gsap
    ```
  </Step>
  <Step>
    Copy the component code into your project.
  </Step>
</Steps>

## Usage

```tsx
import { MagneticButton } from "@/components/craft/magnetic-button";

export default function Demo() {
  return (
    <MagneticButton onClick={() => console.log("clicked")}>
      Get Started
    </MagneticButton>
  );
}
```

## Props

<PropsTable props={[
  { name: "children", description: "Content to display inside the button." },
  { name: "className", description: "Additional CSS classes for styling." },
  { name: "onClick", description: "Click handler function." },
  { name: "hoverVariant", description: "Predefined color variant for the flair." },
  { name: "customColor", description: "Custom hex/rgb color (overrides hoverVariant)." }
]} />


--- src/content/scroll-reveal-text/ScrollRevealText.tsx ---

'use client';

import { useRef, useMemo, useState, useEffect } from "react";
import { motion, useScroll, useTransform, useSpring, MotionValue } from "framer-motion";

// ===========================================================================
// TYPES
// ===========================================================================

export interface ScrollRevealTextProps {
    /** The text content to be revealed word by word (required) */
    phrase: string;
    /** Optional heading displayed above the text */
    title?: string;
    /** Words to highlight with primary color */
    highlightWords?: string[];
    /** Hex color for highlighted words (e.g., "#ff6b00") */
    primaryColor?: string;
    /** Animation configuration overrides */
    config?: AnimationConfig;
    /** Optional ref to the scrollable container (useful for previews) */
    scrollContainerRef?: React.RefObject<HTMLDivElement>;
}

export interface AnimationConfig {
    /** How many words ahead show animated boxes */
    leadCount?: number;
    /** Scroll distance per word in pixels */
    scrollDistance?: number;
    /** Framer Motion spring stiffness */
    springStiffness?: number;
    /** Framer Motion spring damping */
    springDamping?: number;
}

interface AnimatedWordProps {
    word: string;
    index: number;
    totalWords: number;
    scrollProgress: MotionValue<number>;
    isHighlighted: boolean;
    primaryColor: string;
    leadCount: number;
}

// ===========================================================================
// CONFIGURATION - Optimized for smooth, lightweight scrolling
// ===========================================================================

const ANIMATION_CONFIG = {
    leadCount: { desktop: 15, mobile: 10 },
    scrollDistance: { desktop: 60, mobile: 40 },
    paddingDuration: 2,
    // Optimized spring: smoother with less bounce
    spring: {
        stiffness: 60,      // Lower for smoother transitions
        damping: 35,        // Higher for less oscillation/bounce
        restDelta: 0.01     // Less precise = fewer updates = better performance
    },
    phases: {
        emergence: { start: 0, end: 0.15 },
        focus: { start: 0.15, end: 0.60 },
        reveal: { start: 0.60, end: 1.0 }
    }
} as const;

// ===========================================================================
// UTILITIES
// ===========================================================================

/**
 * Converts hex color to RGB string for use in rgba()
 */
const hexToRgb = (hex: string): string => {
    const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    if (!result) return "255, 107, 0";
    return [
        parseInt(result[1], 16),
        parseInt(result[2], 16),
        parseInt(result[3], 16)
    ].join(", ");
};

/**
 * Checks if a word should be highlighted (case-insensitive, handles punctuation)
 */
const isWordHighlighted = (word: string, highlightWords: string[]): boolean => {
    if (!highlightWords?.length) return false;
    return highlightWords.some(hw =>
        word.toLowerCase().includes(hw.toLowerCase())
    );
};

// ===========================================================================
// ANIMATED WORD COMPONENT - Simplified, no shadows/glows
// ===========================================================================

function AnimatedWord({
    word,
    index,
    totalWords,
    scrollProgress,
    isHighlighted,
    primaryColor,
    leadCount,
}: AnimatedWordProps) {
    const rgb = hexToRgb(primaryColor);
    const { phases } = ANIMATION_CONFIG;

    // Calculate this word's animation window within the total scroll
    const wordWindowSize = 1 / (totalWords + leadCount);
    const wordStart = index * wordWindowSize;
    const wordEnd = (index + leadCount + 1) * wordWindowSize;

    // Phase boundaries within this word's window
    const phaseToScroll = (phase: number) => wordStart + (wordEnd - wordStart) * phase;

    // Box opacity: 0 → 0.4 → 1 → 0 (clean fade)
    const boxOpacity = useTransform(
        scrollProgress,
        [
            phaseToScroll(phases.emergence.start),
            phaseToScroll(phases.emergence.end),
            phaseToScroll(phases.focus.end),
            phaseToScroll(phases.reveal.end)
        ],
        [0, 0.4, 1, 0]
    );

    // Box scale: 0.95 → 1 → 1.02 (subtle, smooth)
    const boxScale = useTransform(
        scrollProgress,
        [
            phaseToScroll(phases.emergence.start),
            phaseToScroll(phases.focus.start),
            phaseToScroll(phases.reveal.end)
        ],
        [0.95, 1, 1.02]
    );


    // Box background opacity - simple fade
    const bgOpacity = useTransform(
        scrollProgress,
        [
            phaseToScroll(phases.emergence.start),
            phaseToScroll(phases.focus.start),
            phaseToScroll(phases.focus.end)
        ],
        [0.05, 0.2, isHighlighted ? 0.35 : 0.25]
    );

    // Text opacity: 0 → 1 (during reveal phase)
    const textOpacity = useTransform(
        scrollProgress,
        [phaseToScroll(phases.reveal.start), phaseToScroll(phases.reveal.end)],
        [0, 1]
    );

    // Text Y movement - subtle rise
    const textY = useTransform(
        scrollProgress,
        [phaseToScroll(phases.reveal.start), phaseToScroll(phases.reveal.end)],
        [3, 0]
    );

    return (
        <span
            className="relative inline-block align-middle"
            style={{
                margin: '0 0.12em',
                fontFamily: 'var(--font-poly, sans-serif)',
            }}
        >
            {/* Text element - NO text shadow */}
            <motion.span
                className="relative z-[2] whitespace-nowrap"
                style={{
                    opacity: textOpacity,
                    y: textY,
                    color: isHighlighted ? primaryColor : undefined,
                    transition: 'color 0.3s ease'
                }}
            >
                {word}
            </motion.span>

            {/* Glassmorphic pill - NO shadow, NO glow */}
            <motion.span
                aria-hidden="true"
                className="absolute z-[1] left-1/2 top-1/2 pointer-events-none rounded-full"
                style={{
                    width: '102%',
                    height: '70%',
                    x: "-50%",
                    y: "-50%",
                    opacity: boxOpacity,
                    scale: boxScale,
                    backgroundColor: useTransform(
                        bgOpacity,
                        (v) => isHighlighted
                            ? `rgba(${rgb}, ${v})`
                            : `rgba(255, 255, 255, ${v})`
                    ),
                    border: isHighlighted
                        ? `1px solid rgba(${rgb}, 0.2)`
                        : '1px solid rgba(255, 255, 255, 0.08)',
                }}
            />
        </span>
    );
}

// ===========================================================================
// MAIN COMPONENT - Lightweight, smooth scrolling
// ===========================================================================

/**
 * ScrollRevealTextFramer Component
 * 
 * A scroll-locked text reveal animation powered by Framer Motion.
 * Optimized for smooth, lightweight scrolling performance.
 * 
 * @example
 * ```tsx
 * <ScrollRevealTextFramer 
 *   phrase="Your text here" 
 *   highlightWords={["text"]}
 *   primaryColor="#00ff88"
 * />
 * ```
 */
export function ScrollRevealTextFramer({
    phrase = "",
    highlightWords = [],
    title = "",
    primaryColor = "#ff6b00",
    config = {},
    scrollContainerRef
}: ScrollRevealTextProps) {
    const containerRef = useRef<HTMLDivElement>(null);
    const words = useMemo(() => phrase.split(" "), [phrase]);

    // Detect mobile for responsive adjustments
    const [isMobile, setIsMobile] = useState(false);

    useEffect(() => {
        const checkMobile = () => setIsMobile(window.innerWidth < 800);
        checkMobile();
        window.addEventListener('resize', checkMobile);
        return () => window.removeEventListener('resize', checkMobile);
    }, []);

    // Merge config with defaults
    const leadCount = config.leadCount ?? (isMobile
        ? ANIMATION_CONFIG.leadCount.mobile
        : ANIMATION_CONFIG.leadCount.desktop);

    const scrollDistance = config.scrollDistance ?? (isMobile
        ? ANIMATION_CONFIG.scrollDistance.mobile
        : ANIMATION_CONFIG.scrollDistance.desktop);

    // Optimized spring config
    const springConfig = {
        stiffness: config.springStiffness ?? ANIMATION_CONFIG.spring.stiffness,
        damping: config.springDamping ?? ANIMATION_CONFIG.spring.damping,
        restDelta: ANIMATION_CONFIG.spring.restDelta
    };

    // Total scroll distance for the animation
    const totalScrollDistance = (words.length + leadCount) * scrollDistance +
        (ANIMATION_CONFIG.paddingDuration * scrollDistance);

    // Track scroll progress
    const { scrollYProgress } = useScroll({
        target: containerRef,
        container: (scrollContainerRef && scrollContainerRef.current) ? scrollContainerRef : undefined,
        offset: ["start start", "end end"]
    });

    // Single spring for all words - more efficient
    const smoothProgress = useSpring(scrollYProgress, {
        stiffness: springConfig.stiffness,
        damping: springConfig.damping,
        restDelta: springConfig.restDelta,
    });

    // Get container height for sticky element sizing
    const [containerHeight, setContainerHeight] = useState("100vh");

    useEffect(() => {
        if (scrollContainerRef?.current) {
            const updateHeight = () => {
                const height = scrollContainerRef.current?.clientHeight || window.innerHeight;
                setContainerHeight(`${height}px`);
            };
            updateHeight();
            window.addEventListener('resize', updateHeight);
            return () => window.removeEventListener('resize', updateHeight);
        }
    }, [scrollContainerRef]);

    return (
        <div
            ref={containerRef}
            className="w-full relative"
            style={{
                height: `calc(${totalScrollDistance}px + ${containerHeight})`,
                color: 'var(--color-text, #fff)'
            }}
        >
            {/* Sticky inner container - pins content while scrolling */}
            <div
                className="w-full flex items-center justify-center sticky top-0 z-[1]"
                style={{
                    height: containerHeight,
                }}
            >
                {/* Content wrapper with responsive sizing */}
                <div
                    className="w-full mx-auto"
                    style={{
                        maxWidth: isMobile ? '100%' : '680px',
                        padding: isMobile ? '0 1rem' : '0 2rem',
                        overflowWrap: 'break-word',
                        boxSizing: 'border-box'
                    }}
                >
                    {/* Title */}
                    {title && (
                        <h1
                            className="font-bold leading-[1.15]"
                            style={{
                                fontSize: isMobile
                                    ? 'clamp(1.5rem, 8vw, 2.25rem)'
                                    : 'clamp(2.5rem, 5vw, 5rem)',
                                marginBottom: isMobile ? '1.25rem' : '2rem',
                                letterSpacing: '-0.03em',
                            }}
                        >
                            {title}
                        </h1>
                    )}

                    {/* Body text container */}
                    <div
                        className="flex flex-wrap max-w-full"
                        style={{
                            fontSize: isMobile
                                ? 'clamp(1.08rem, 4.8vw, 1.32rem)'
                                : 'clamp(1.44rem, 2.64vw, 2.22rem)',
                            fontWeight: 600,
                            lineHeight: isMobile ? 1.75 : 1.42,
                            rowGap: isMobile ? '0.3em' : '0.18em',
                            wordSpacing: isMobile ? '0.06em' : '0.025em'
                        }}
                    >
                        {words.map((word, index) => (
                            <AnimatedWord
                                key={index}
                                word={word}
                                index={index}
                                totalWords={words.length}
                                scrollProgress={smoothProgress}
                                isHighlighted={isWordHighlighted(word, highlightWords)}
                                primaryColor={primaryColor}
                                leadCount={leadCount}
                            />
                        ))}
                    </div>
                </div>
            </div>
        </div>
    );
}

export default ScrollRevealTextFramer;


--- src/content/scroll-reveal-text/index.mdx ---

---
name: "scroll-reveal-text"
title: "Scroll Reveal Text"
description: "Scroll-locked text reveal with glassmorphic pill overlays that emerge, glow, and dissolve as you scroll."
category: "Animation"
version: "3.0.0"
dependencies: ["framer-motion"]
source: "src/content/scroll-reveal-text/index.mdx"
---

## Installation

<Steps>
  <Step>
    Install the required dependencies:
    ```bash
    npm install framer-motion
    ```
  </Step>
  <Step>
    Copy the component code and CSS modules into your project.
  </Step>
</Steps>

## Usage

```tsx
import { ScrollRevealText } from '@/components/scroll-reveal-text';

export default function Hero() {
  return (
    <ScrollRevealText
      phrase="Spring-based animations with smooth scroll dampening."
      highlightWords={["Spring", "smooth"]}
      primaryColor="#6366f1"
    />
  );
}
```

## Props

<PropsTable props={[
  { name: "phrase", description: "The text content to be revealed word by word." },
  { name: "title", description: "Optional heading displayed above the text." },
  { name: "highlightWords", description: "Words to highlight with the accent color." },
  { name: "primaryColor", description: "Hex color for highlighted words and glows." },
  { name: "config", description: "Animation parameters like leadCount and scrollDistance." }
]} />


--- src/hooks/use-mounted.ts ---

"use client";

import { useEffect, useState } from "react";

export function useMounted() {
  const [mounted, setMounted] = useState(false);

  useEffect(() => {
    setMounted(true);
  }, []);

  return mounted;
}


--- src/lib/docs/SectionRenderer.tsx ---

"use client";

import React from "react";
import { Icon } from "@iconify/react";
import { DocsPageConfig, Interaction } from "./schema";
import { getMDXComponents } from "@/lib/mdx/components";
import { ComponentCodeWrapper, DemoCodeWrapper } from "@/lib/mdx/SourceCodeWrapper";
import { Steps, Step } from "@/components/mdx/Steps";
import { PropsTable, PropItem } from "@/components/mdx/PropsTable";
import { Callout } from "@/components/mdx/Callout";
import { MDXContent } from "@/lib/mdx/MDXContent";
import { ErrorBoundary } from "@/components/ErrorBoundary";

export function SectionRenderer({ config }: { config: DocsPageConfig }) {
  const { description, dependencies, interactions, license, showSource, mdxContent } = config;

  const mdxComponents = {
    ...getMDXComponents(),
    ComponentCode: () => null,
    DemoCode: () => null,
    Steps: ({ children }: { children: React.ReactNode }) => <div className="space-y-4">{children}</div>,
    Step: ({ children }: { children: React.ReactNode }) => <div className="docs-step-plain">{children}</div>,
    PropsTable,
    PropItem,
    Callout,
    ComponentPreview: () => null,
    h1: () => null,
  };

  return (
    <>
      {/* Description Section */}
      {description && (
        <section className="mb-14">
          <p className="text-lg text-foreground/90 leading-relaxed tracking-tight">
            {description}
          </p>
        </section>
      )}

      {/* Dependencies Section */}
      {dependencies && dependencies.length > 0 && (
        <section className="mb-12">
          <h3 className="docs-h3 flex items-center gap-2 text-foreground font-medium mb-4">Dependencies</h3>
          <div className="flex flex-wrap items-center gap-2">
            {dependencies.map((dep) => (
              <a
                key={dep}
                href={dep === "framer-motion" ? "https://motion.dev/" : `https://www.npmjs.com/package/${dep}`}
                target="_blank"
                rel="noopener noreferrer"
                className="bg-muted hover:bg-muted/80 flex h-9 w-fit cursor-pointer items-center gap-2 rounded-xl px-3 text-xs font-mono transition-all duration-300 border border-border/5"
              >
                {dep}
                {dep === "framer-motion" && <Icon icon="simple-icons:framer" className="size-3" />}
                {dep === "lucide-react" && <Icon icon="simple-icons:lucide" className="size-4" />}
                {dep === "gsap" && <Icon icon="simple-icons:greensock" className="size-4" />}
                {dep === "animejs" && <Icon icon="simple-icons:javascript" className="size-4" />}
              </a>
            ))}
          </div>
        </section>
      )}

      {/* Interactions Section */}
      {interactions && interactions.length > 0 && (
        <section className="mb-12">
          <h3 className="docs-h3 text-foreground font-medium mb-4">Interaction</h3>
          <table className="w-full">
            <tbody>
              {interactions.map((interaction: Interaction, i: number) => (
                <tr key={i} className="border-foreground/10 h-12 border-t tracking-tight last:border-b">
                  <td className="w-1/4">
                    <InteractionIcon type={interaction.type} />
                  </td>
                  <td className="text-lg text-muted-foreground">{interaction.description}</td>
                </tr>
              ))}
            </tbody>
          </table>
        </section>
      )}

      {/* MDX Content (Installation, Usage, Props) */}
      <article className="docs-article prose prose-zinc dark:prose-invert max-w-none mb-12">
        {mdxContent ? (
          <ErrorBoundary componentName="Documentation">
            <MDXContent
              source={mdxContent}
              components={mdxComponents}
            />
          </ErrorBoundary>
        ) : (
          <p className="text-muted-foreground italic">No documentation available.</p>
        )}
      </article>

      {/* Source Code Section info */}
      {showSource && (
        <section className="mb-12">
          <h3 className="docs-h3 text-foreground font-medium mb-4">Source code</h3>
          <p className="docs-p flex items-center gap-2 flex-wrap text-muted-foreground">
            Click on the top right
            <span className="flex items-center justify-center bg-muted size-8 rounded-xl border border-border/10">
              <Icon icon="lucide:code-2" className="size-4" />
            </span>
            to view the source code implementation.
          </p>
        </section>
      )}

      {/* License Section */}
      {license && license.length > 0 && (
        <section>
          <h3 className="docs-h3 text-foreground font-medium mb-4">License & Usage</h3>
          <ul className="space-y-2 list-none p-0">
            {license.map((item, i) => (
              <li key={i} className="text-lg text-muted-foreground flex items-start gap-2">
                <span className="text-muted-foreground/60 font-medium shrink-0">-</span>
                {item}
              </li>
            ))}
          </ul>
        </section>
      )}
    </>
  );
}

function InteractionIcon({ type }: { type: Interaction["type"] }) {
  switch (type) {
    case "click": return <Icon icon="lucide:mouse-pointer-click" className="size-5" />;
    case "hover": return <Icon icon="lucide:pointer" className="size-5" />;
    case "scroll": return <Icon icon="lucide:mouse" className="size-5" />;
    case "drag": return <Icon icon="lucide:move" className="size-5" />;
    case "input": return <Icon icon="lucide:keyboard" className="size-5" />;
    default: return <Icon icon="lucide:info" className="size-5" />;
  }
}


--- src/lib/docs/engine.ts ---

import { getAllComponentsMetadata, getComponentMetadata } from "../registry/resolver";
import { loadComponentMDX } from "../mdx/loader";
import { DocsPageConfig, DocsPageConfigSchema } from "./schema";

export async function buildDocsPage(slug: string): Promise<DocsPageConfig> {
  const metadata = getComponentMetadata(slug);
  if (!metadata) {
    throw new Error(`Component ${slug} not found in registry`);
  }

  let config;
  try {
    const mdx = await loadComponentMDX(slug);
    const components = getAllComponentsMetadata();
    const index = components.findIndex(c => c.id === slug);

    const prev = index > 0 ? { id: components[index - 1].id, title: components[index - 1].title } : null;
    const next = index < components.length - 1 ? { id: components[index + 1].id, title: components[index + 1].title } : null;

    // Interactions mapping based on registry or design metadata if interactions missing
    // This is where we bridge the "hard-coded" gap
    const interactions = metadata.demo.scrollable
      ? [{ type: "scroll", description: "Scroll down to see the reveal animation" }]
      : [
        { type: "click", description: "Click on items to see transitions" },
        { type: "hover", description: "Hover for additional effects" }
      ];

    config = {
      id: metadata.id,
      title: metadata.title,
      description: metadata.description,
      category: metadata.category,
      status: metadata.status,
      pricing: metadata.pricing,
      dependencies: metadata.dependencies || [],
      interactions: (metadata as any).interactions || interactions,
      license: (metadata as any).license || [
        "Free to use and modify in both personal and commercial projects.",
        "Attribution to Skie Media is appreciated but not required."
      ],
      showSource: metadata.source.type === "mdx",
      mdxContent: mdx?.source,
      prev,
      next,
    };
  } catch (e) {
    console.error(`Error building docs page for ${slug}:`, e);
    throw e;
  }

  return DocsPageConfigSchema.parse(config);
}


--- src/lib/docs/schema.ts ---

import { z } from "zod";
import { ComponentCategory, ComponentPricing, ComponentStatus } from "../types";

export const InteractionSchema = z.object({
  type: z.enum(["click", "hover", "scroll", "drag", "input"]),
  description: z.string(),
});

export type Interaction = z.infer<typeof InteractionSchema>;

export const DocsPageConfigSchema = z.object({
  id: z.string(),
  title: z.string(),
  description: z.string(),
  category: z.string(),
  status: z.string(),
  pricing: z.string(),
  dependencies: z.array(z.string()).default([]),
  interactions: z.array(InteractionSchema).optional(),
  license: z.array(z.string()).optional(),
  showSource: z.boolean().default(true),
  mdxContent: z.any().optional(), // Serialized MDX Source
  prev: z.object({ id: z.string(), title: z.string() }).nullable(),
  next: z.object({ id: z.string(), title: z.string() }).nullable(),
});

export type DocsPageConfig = z.infer<typeof DocsPageConfigSchema>;


--- src/lib/errors.ts ---

/**
 * Custom Error Classes
 * 
 * Provides typed error classes for better error handling and discrimination.
 */

/**
 * SecurityError - thrown when a security violation is detected.
 * 
 * Used for:
 * - Path traversal attempts
 * - Invalid component ID formats
 * - Unknown component access attempts
 */
export class SecurityError extends Error {
    constructor(
        message: string,
        public readonly code: SecurityErrorCode = 'SECURITY_ERROR'
    ) {
        super(message);
        this.name = 'SecurityError';

        // Maintains proper stack trace for where error was thrown (V8 engines)
        if (Error.captureStackTrace) {
            Error.captureStackTrace(this, SecurityError);
        }
    }
}

export type SecurityErrorCode =
    | 'SECURITY_ERROR'
    | 'INVALID_ID_FORMAT'
    | 'UNKNOWN_COMPONENT'
    | 'PATH_TRAVERSAL_ATTEMPT';


--- src/lib/mdx/MDXContent.tsx ---

'use client';

import { MDXRemote, type MDXRemoteSerializeResult } from 'next-mdx-remote';
import React, { useEffect, useState } from 'react';

interface MDXContentProps {
  source: MDXRemoteSerializeResult;
  components?: Record<string, React.ComponentType<any>>;
}

export function MDXContent({ source, components }: MDXContentProps) {
  const [isMounted, setIsMounted] = useState(false);

  useEffect(() => {
    setIsMounted(true);
  }, []);

  if (!source || !isMounted) return null;
  
  return <MDXRemote {...source} components={components} />;
}


--- src/lib/mdx/SourceCodeWrapper.tsx ---

"use client";

/**
 * Client-side wrapper for SourceCode display in MDX
 * 
 * These components fetch and display source code from the codebase.
 * They're used in MDX files like:
 *   <DemoCode name="adaptive-tooltip" />
 *   <ComponentCode name="adaptive-tooltip" />
 */

import * as React from "react";
import { CodeBlock } from "@/components/code/CodeBlock";

interface SourceCodeProps {
  name: string;
  title?: string;
}

/**
 * DemoCode - Display the demo source code for a component
 */
export function DemoCodeWrapper({ name, title }: SourceCodeProps) {
  const [code, setCode] = React.useState<string | null>(null);
  const [loading, setLoading] = React.useState(true);
  const [error, setError] = React.useState<string | null>(null);

  React.useEffect(() => {
    const fetchCode = async () => {
      try {
        const res = await fetch(`/api/source?type=demo&name=${name}`);
        if (!res.ok) throw new Error("Failed to fetch demo code");
        const data = await res.json();
        setCode(data.code);
      } catch (err) {
        setError(err instanceof Error ? err.message : "Unknown error");
      } finally {
        setLoading(false);
      }
    };
    fetchCode();
  }, [name]);

  if (loading) {
    return (
      <div className="my-6 rounded-xl bg-muted/20 p-8 flex items-center justify-center">
        <div className="flex items-center gap-2 text-muted-foreground text-sm">
          <div className="h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent" />
          Loading demo code...
        </div>
      </div>
    );
  }

  if (error || !code) {
    return (
      <div className="my-6 rounded-xl bg-muted/20 p-4 text-muted-foreground text-sm">
        Unable to load demo code for <code className="bg-muted px-1.5 py-0.5 rounded">{name}</code>
      </div>
    );
  }

  return (
    <div className="my-6">
      {title && <h3 className="text-lg font-medium mb-3">{title}</h3>}
      <CodeBlock code={code} language="tsx" filename={`${toPascalCase(name)}Demo.tsx`} />
    </div>
  );
}

/**
 * ComponentCode - Display the full component source code
 */
export function ComponentCodeWrapper({ name, title }: SourceCodeProps) {
  const [code, setCode] = React.useState<string | null>(null);
  const [loading, setLoading] = React.useState(true);
  const [error, setError] = React.useState<string | null>(null);

  React.useEffect(() => {
    const fetchCode = async () => {
      try {
        const res = await fetch(`/api/source?type=component&name=${name}`);
        if (!res.ok) throw new Error("Failed to fetch component code");
        const data = await res.json();
        setCode(data.code);
      } catch (err) {
        setError(err instanceof Error ? err.message : "Unknown error");
      } finally {
        setLoading(false);
      }
    };
    fetchCode();
  }, [name]);

  if (loading) {
    return (
      <div className="my-6 rounded-xl bg-muted/20 p-8 flex items-center justify-center">
        <div className="flex items-center gap-2 text-muted-foreground text-sm">
          <div className="h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent" />
          Loading component code...
        </div>
      </div>
    );
  }

  if (error || !code) {
    return (
      <div className="my-6 rounded-xl bg-muted/20 p-4 text-muted-foreground text-sm">
        Unable to load component code for <code className="bg-muted px-1.5 py-0.5 rounded">{name}</code>
      </div>
    );
  }

  return (
    <div className="my-6">
      {title && <h3 className="text-lg font-medium mb-3">{title}</h3>}
      <CodeBlock code={code} language="tsx" filename={`${name}.tsx`} />
    </div>
  );
}

function toPascalCase(str: string): string {
  return str
    .split("-")
    .map((w) => w.charAt(0).toUpperCase() + w.slice(1))
    .join("");
}


--- src/lib/mdx/compiler.ts ---

import matter from 'gray-matter';
import { serialize } from 'next-mdx-remote/serialize';
import remarkGfm from 'remark-gfm';
import { LRUCache } from 'lru-cache';

/**
 * MDX Compiler with LRU Cache
 * 
 * Features:
 * - LRU eviction with configurable max size (50MB default)
 * - TTL-based expiration (1 hour)
 * - Size-based eviction using serialized content length
 */

interface CachedMDX {
  source: any;
  compiledAt: number;
}

// LRU Cache configuration
const CACHE_MAX_SIZE_BYTES = 50 * 1024 * 1024; // 50MB
const CACHE_TTL_MS = 1000 * 60 * 60; // 1 hour
const CACHE_MAX_ENTRIES = 200;

/**
 * Calculate approximate size of compiled MDX in bytes
 */
function calculateSize(value: CachedMDX): number {
  // Rough estimate: JSON stringify length in bytes
  try {
    return JSON.stringify(value.source).length * 2; // *2 for UTF-16
  } catch {
    return 1024; // Default 1KB if can't calculate
  }
}

/**
 * LRU Cache for compiled MDX
 * - Evicts least recently used items when size limit reached
 * - Automatically expires items after TTL
 */
const compiledMDXCache = new LRUCache<string, CachedMDX>({
  max: CACHE_MAX_ENTRIES,
  maxSize: CACHE_MAX_SIZE_BYTES,
  sizeCalculation: calculateSize,
  ttl: CACHE_TTL_MS,
  // In development, don't use TTL to allow hot reload
  ttlAutopurge: process.env.NODE_ENV === 'production',
});

/**
 * Compile MDX content using next-mdx-remote
 * Returns the serialized source instead of a component to allow RSC boundary crossing
 */
export async function compileMDX(
  source: string,
  cacheKey?: string
): Promise<{ source: any }> {
  // Check cache
  if (cacheKey) {
    const cached = compiledMDXCache.get(cacheKey);
    if (cached) {
      return { source: cached.source };
    }
  }

  const { content } = matter(source);

  const mdxSource = await serialize(content, {
    mdxOptions: {
      remarkPlugins: [remarkGfm],
      rehypePlugins: [],
    },
    parseFrontmatter: false,
  });

  // Cache the result
  if (cacheKey) {
    compiledMDXCache.set(cacheKey, {
      source: mdxSource,
      compiledAt: Date.now(),
    });
  }

  return { source: mdxSource };
}

export async function compileAndExecuteMDX(
  source: string,
  cacheKey?: string
): Promise<{ source: any }> {
  return compileMDX(source, cacheKey);
}

export function clearMDXCache(): void {
  compiledMDXCache.clear();
}

export function getMDXCacheStats() {
  return {
    size: compiledMDXCache.size,
    calculatedSize: compiledMDXCache.calculatedSize,
    maxSize: CACHE_MAX_SIZE_BYTES,
    maxEntries: CACHE_MAX_ENTRIES,
    ttl: CACHE_TTL_MS,
  };
}



--- src/lib/mdx/components.tsx ---

/**
 * MDX Components Provider
 * 
 * Defines custom components available in MDX files.
 * This is the "component mapping" that allows MDX to use:
 * - Custom UI components (ComponentPreview, CodeBlock, Callout, Steps)
 * - Enhanced HTML elements (custom headings, links, etc.)
 * - Registry-based component resolution
 * 
 * AVAILABLE COMPONENTS:
 * - ComponentPreview: Renders a component from the registry
 * - Callout: Info, warning, error, success callouts
 * - Steps/Step: Numbered step-by-step guides
 * - PropsTable: API documentation tables
 * - PropItem: Inline prop documentation
 * - DemoCode: Shows source code for demos
 * - ComponentCode: Shows component source code
 */

import type { ComponentType, ReactNode } from 'react';
import { CodeBlock } from '@/components/code/CodeBlock';
import { ComponentPreview } from '@/components/craft/ComponentPreview';
import { DemoCodeWrapper, ComponentCodeWrapper } from './SourceCodeWrapper';
import { Callout } from '@/components/mdx/Callout';
import { Steps, Step } from '@/components/mdx/Steps';
import { PropsTable, PropItem } from '@/components/mdx/PropsTable';
import { cn } from "@/lib/utils";

/**
 * Component map type for MDX
 * 
 * Keys are either:
 * - HTML elements: 'h1', 'h2', 'p', 'pre', 'code', etc.
 * - Custom components: 'ComponentPreview', 'Callout', 'Steps', etc.
 */
export type MDXComponents = Record<string, ComponentType<any>>;

/**
 * Custom heading components with proper anchors
 */
function H1({ children, ...props }: any) {
  const id = typeof children === 'string'
    ? children.toLowerCase().replace(/\s+/g, '-')
    : undefined;

  return (
    <h1
      id={id}
      className="scroll-mt-20 text-4xl font-semibold tracking-tight text-foreground mb-6"
      {...props}
    >
      {children}
    </h1>
  );
}

function H2({ children, ...props }: any) {
  const id = typeof children === 'string'
    ? children.toLowerCase().replace(/\s+/g, '-')
    : undefined;

  return (
    <h2
      id={id}
      className="text-2xl font-medium tracking-tight text-foreground mt-12 mb-4 scroll-mt-24"
      {...props}
    >
      {children}
    </h2>
  );
}

function H3({ children, ...props }: any) {
  const id = typeof children === 'string'
    ? children.toLowerCase().replace(/\s+/g, '-')
    : undefined;

  return (
    <h3
      id={id}
      className="text-lg font-medium tracking-tight mt-8 mb-3 text-foreground scroll-mt-24"
      {...props}
    >
      {children}
    </h3>
  );
}

/**
 * Custom paragraph with better typography
 */
function P({ children, ...props }: any) {
  return (
    <p className="text-lg leading-relaxed text-muted-foreground mb-4 last:mb-0" {...props}>
      {children}
    </p>
  );
}

/**
 * Custom list components
 */
function Ul({ children, ...props }: any) {
  return (
    <ul className="my-6 ml-6 list-none space-y-2 max-w-[69ch]" {...props}>
      {children}
    </ul>
  );
}

function Li({ children, ...props }: any) {
  return (
    <li className="relative pl-6" {...props}>
      <span className="absolute left-0 top-0 text-muted-foreground/60 font-medium">-</span>
      <span className="text-lg text-muted-foreground leading-relaxed">{children}</span>
    </li>
  );
}

/**
 * Ordered list component
 */
function Ol({ children, ...props }: any) {
  return (
    <ol className="my-6 ml-6 list-decimal space-y-2 marker:text-muted-foreground/60 marker:font-medium max-w-[69ch]" {...props}>
      {children}
    </ol>
  );
}

/**
 * Blockquote component
 */
function Blockquote({ children, ...props }: any) {
  return (
    <blockquote
      className="my-6 pl-6 py-3 border-l-2 border-primary/30 text-muted-foreground italic rounded-r-lg"
      {...props}
    >
      {children}
    </blockquote>
  );
}

/**
 * Strong/bold text
 */
function Strong({ children, ...props }: any) {
  return (
    <strong className="font-medium text-foreground" {...props}>
      {children}
    </strong>
  );
}

/**
 * Emphasis/italic text
 */
function Em({ children, ...props }: any) {
  return (
    <em className="italic text-foreground/80" {...props}>
      {children}
    </em>
  );
}

/**
 * Horizontal rule
 */
function Hr(props: any) {
  return <hr className="my-8 border-border/10" {...props} />;
}

/**
 * Anchor/link component
 */
function A({ children, href, ...props }: any) {
  const isExternal = href?.startsWith('http');
  return (
    <a
      href={href}
      className="font-medium text-primary underline underline-offset-4 decoration-primary/30 hover:decoration-primary transition-all"
      {...(isExternal ? { target: '_blank', rel: 'noopener noreferrer' } : {})}
      {...props}
    >
      {children}
    </a>
  );
}

/**
 * Custom code block component
 */
function Pre({ children, ...props }: any) {
  const code = children?.props?.children;
  const language = children?.props?.className?.replace('language-', '') || 'text';

  if (typeof code === 'string') {
    return (
      <CodeBlock
        code={code.trim()}
        language={language}
        className="my-6"
      />
    );
  }

  return (
    <pre className="my-4 p-4 rounded-lg bg-muted overflow-x-auto" {...props}>
      {children}
    </pre>
  );
}

/**
 * Inline code
 */
function Code({ children, className, ...props }: any) {
  if (className?.includes('language-')) {
    return <code className={className} {...props}>{children}</code>;
  }

  return (
    <code
      className="relative rounded bg-muted/40 px-[0.3rem] py-[0.1rem] font-mono text-sm font-normal text-foreground border border-border/10"
      {...props}
    >
      {children}
    </code>
  );
}

/**
 * Custom table components
 */
function Table({ children, ...props }: any) {
  return (
    <div className="my-6 w-full overflow-hidden rounded-xl border border-border/10 bg-background/50 shadow-sm">
      <div className="overflow-x-auto">
        <table className="w-full text-lg" {...props}>
          {children}
        </table>
      </div>
    </div>
  );
}

function Thead({ children, ...props }: any) {
  return (
    <thead className="border-b border-border/10" {...props}>
      {children}
    </thead>
  );
}

function Th({ children, ...props }: any) {
  return (
    <th className="px-4 py-3 text-left font-normal text-foreground/80 whitespace-nowrap" {...props}>
      {children}
    </th>
  );
}

function Tbody({ children, ...props }: any) {
  return (
    <tbody className="divide-y divide-border/10 bg-background/50" {...props}>
      {children}
    </tbody>
  );
}

function Tr({ children, ...props }: any) {
  return (
    <tr className="hover:bg-muted/10 transition-colors group" {...props}>
      {children}
    </tr>
  );
}

function Td({ children, ...props }: any) {
  return (
    <td className="px-4 py-3 text-lg text-muted-foreground align-top group-hover:text-foreground transition-colors" {...props}>
      {children}
    </td>
  );
}

/**
 * Image component
 */
function Img({ src, alt, ...props }: any) {
  return (
    // eslint-disable-next-line @next/next/no-img-element
    <img
      src={src}
      alt={alt}
      className="rounded-xl border border-border/10 my-8 w-full h-auto shadow-sm"
      {...props}
    />
  );
}

/**
 * Get MDX components map
 */
export function getMDXComponents(): MDXComponents {
  return {
    // Custom components
    ComponentPreview,
    DemoCode: DemoCodeWrapper,
    ComponentCode: ComponentCodeWrapper,
    Callout,
    Steps,
    Step,
    PropsTable,
    PropItem,
    // HTML elements
    h1: H1,
    h2: H2,
    h3: H3,
    p: P,
    ul: Ul,
    ol: Ol,
    li: Li,
    pre: Pre,
    code: Code,
    table: Table,
    thead: Thead,
    th: Th,
    tbody: Tbody,
    tr: Tr,
    td: Td,
    blockquote: Blockquote,
    strong: Strong,
    em: Em,
    hr: Hr,
    a: A,
    img: Img,
  };
}

export function mergeMDXComponents(
  overrides: Partial<MDXComponents>
): MDXComponents {
  return {
    ...getMDXComponents(),
    ...overrides,
  } as MDXComponents;
}


--- src/lib/mdx/frontmatter-schema.ts ---

/**
 * MDX Frontmatter Schema
 * 
 * Zod schema for validating MDX frontmatter at parse time.
 * If validation fails, returns safe defaults and logs warning.
 */

import { z } from 'zod';

// Frontmatter schema - all fields optional with safe defaults
export const MDXFrontmatterSchema = z.object({
    name: z.string().optional().default('Untitled'),
    title: z.string().optional().default('Untitled'),
    description: z.string().optional().default(''),
    category: z.string().optional().default('uncategorized'),
    version: z.string().optional(),
    source: z.string().optional(),
    tags: z.array(z.string()).optional().default([]),
    dependencies: z.array(z.string()).optional().default([]),
}).passthrough(); // Allow additional fields

// Safe default frontmatter for when parsing fails
export const DEFAULT_FRONTMATTER: MDXFrontmatter = {
    name: 'Untitled',
    title: 'Untitled',
    description: '',
    category: 'uncategorized',
    tags: [],
    dependencies: [],
};

// Type export
export type MDXFrontmatter = z.infer<typeof MDXFrontmatterSchema>;

/**
 * Safely parse frontmatter with fallback to defaults.
 * Logs warning on parse failure but doesn't throw.
 */
export function parseFrontmatter(data: unknown): MDXFrontmatter {
    const result = MDXFrontmatterSchema.safeParse(data);

    if (!result.success) {
        console.warn('[MDX] Frontmatter validation failed:', result.error.format());
        return DEFAULT_FRONTMATTER;
    }

    return result.data;
}


--- src/lib/mdx/index.ts ---

/**
 * MDX System - Central Export
 * 
 * Complete MDX compilation and rendering system for Next.js App Router.
 * 
 * ARCHITECTURE:
 * - Compiler: MDX → JavaScript (cached)
 * - Loader: Filesystem → Compiled MDX
 * - Components: Custom component mapping
 * - Performance: Monitoring and optimization
 * 
 * USAGE:
 * ```tsx
 * import { loadComponentMDX, getMDXComponents } from '@/lib/mdx';
 * 
 * const mdx = await loadComponentMDX('adaptive-tooltip');
 * return <mdx.Component components={getMDXComponents()} />;
 * ```
 */

// Core compilation
export {
  compileMDX,
  compileAndExecuteMDX,
  clearMDXCache,
  getMDXCacheStats,
} from './compiler';

// File loading
export {
  loadMDXFile,
  loadComponentMDX,
  preloadComponentMDX,
  type LoadedMDX,
} from './loader';

// Component mapping
export {
  getMDXComponents,
  mergeMDXComponents,
  type MDXComponents,
} from './components';

// Build-time utilities
export {
  preloadAllMDX,
  validateMDXCompilation,
} from './preload';

// Performance monitoring
export {
  mdxPerformanceMonitor,
  measureAsync,
  assertCompilePerformance,
  checkCacheHealth,
} from './performance';

// Types
export type {
  MDXFrontmatter,
} from './types';



--- src/lib/mdx/loader.ts ---

import { readFileSync } from 'fs';
import { join } from 'path';
import matter from 'gray-matter';
import { compileAndExecuteMDX } from './compiler';
import { parseFrontmatter, type MDXFrontmatter } from './frontmatter-schema';

export interface LoadedMDX {
  frontmatter: MDXFrontmatter;
  source: any;
  rawContent: string;
}

export async function loadMDXFile(filePath: string): Promise<LoadedMDX> {
  const rawContent = readFileSync(filePath, 'utf-8');
  const { data } = matter(rawContent);

  // Validate frontmatter with Zod (returns safe defaults on failure)
  const frontmatter = parseFrontmatter(data);

  const { source } = await compileAndExecuteMDX(
    rawContent,
    filePath
  );

  return {
    frontmatter,
    source,
    rawContent,
  };
}

export async function loadComponentMDX(slug: string): Promise<LoadedMDX | null> {
  try {
    const mdxPath = join(
      process.cwd(),
      'src',
      'content',
      slug,
      'index.mdx'
    );

    return await loadMDXFile(mdxPath);
  } catch (error) {
    console.error(`Failed to load MDX for component "${slug}":`, error);
    return null;
  }
}

export async function preloadComponentMDX(slugs: string[]): Promise<Map<string, LoadedMDX>> {
  const loaded = new Map<string, LoadedMDX>();

  for (const slug of slugs) {
    try {
      const mdx = await loadComponentMDX(slug);
      if (mdx) {
        loaded.set(slug, mdx);
      }
    } catch (error) {
      console.error(`Failed to preload MDX for "${slug}":`, error);
    }
  }

  return loaded;
}


--- src/lib/mdx/performance.ts ---

/**
 * MDX Performance Monitor
 * 
 * Tracks MDX compilation and rendering performance
 * to ensure the system remains fast.
 * 
 * Key metrics:
 * - Compilation time (should be cached after first compile)
 * - Cache hit/miss ratio
 * - Memory usage
 * - Render time
 */

import { getMDXCacheStats } from './compiler';

interface PerformanceMetrics {
  compilations: number;
  cacheHits: number;
  cacheMisses: number;
  totalCompileTime: number;
  averageCompileTime: number;
}

class MDXPerformanceMonitor {
  private metrics: PerformanceMetrics = {
    compilations: 0,
    cacheHits: 0,
    cacheMisses: 0,
    totalCompileTime: 0,
    averageCompileTime: 0,
  };

  recordCompilation(duration: number, fromCache: boolean) {
    this.metrics.compilations++;

    if (fromCache) {
      this.metrics.cacheHits++;
    } else {
      this.metrics.cacheMisses++;
      this.metrics.totalCompileTime += duration;
      this.metrics.averageCompileTime =
        this.metrics.totalCompileTime / this.metrics.cacheMisses;
    }
  }

  getMetrics(): PerformanceMetrics & { cacheStats: ReturnType<typeof getMDXCacheStats> } {
    return {
      ...this.metrics,
      cacheStats: getMDXCacheStats(),
    };
  }

  getCacheHitRate(): number {
    if (this.metrics.compilations === 0) return 0;
    return this.metrics.cacheHits / this.metrics.compilations;
  }

  reset() {
    this.metrics = {
      compilations: 0,
      cacheHits: 0,
      cacheMisses: 0,
      totalCompileTime: 0,
      averageCompileTime: 0,
    };
  }

  logReport() {
    const metrics = this.getMetrics();
    const hitRate = (this.getCacheHitRate() * 100).toFixed(1);

    console.log('\n📊 MDX Performance Report:');
    console.log(`   Compilations: ${metrics.compilations}`);
    console.log(`   Cache hits: ${metrics.cacheHits} (${hitRate}%)`);
    console.log(`   Cache misses: ${metrics.cacheMisses}`);
    console.log(`   Avg compile time: ${Math.round(metrics.averageCompileTime)}ms`);
    console.log(`   Cache size: ${metrics.cacheStats.size}/${metrics.cacheStats.maxEntries}`);
  }
}

// Singleton instance
export const mdxPerformanceMonitor = new MDXPerformanceMonitor();

/**
 * Measure async function execution time
 */
export async function measureAsync<T>(
  name: string,
  fn: () => Promise<T>
): Promise<T> {
  const start = performance.now();
  try {
    return await fn();
  } finally {
    const duration = performance.now() - start;
    if (process.env.NODE_ENV === 'development') {
      console.log(`[MDX Perf] ${name}: ${Math.round(duration)}ms`);
    }
  }
}

/**
 * Performance assertion: fail if MDX compilation takes too long
 */
export function assertCompilePerformance(duration: number, maxMs: number = 500) {
  if (duration > maxMs) {
    console.warn(
      `[MDX Perf] ⚠️  Compilation took ${Math.round(duration)}ms (expected <${maxMs}ms)\n` +
      `This may indicate MDX file is too complex or needs optimization.`
    );
  }
}

/**
 * Check cache health
 * 
 * Ensures cache hit rate is acceptable for production
 */
export function checkCacheHealth(minHitRate: number = 0.8): boolean {
  const hitRate = mdxPerformanceMonitor.getCacheHitRate();

  if (hitRate < minHitRate && mdxPerformanceMonitor.getMetrics().compilations > 10) {
    console.warn(
      `[MDX Perf] ⚠️  Cache hit rate is ${(hitRate * 100).toFixed(1)}% ` +
      `(expected >${(minHitRate * 100).toFixed(0)}%)\n` +
      `This suggests cache is not working properly or is being invalidated too often.`
    );
    return false;
  }

  return true;
}


--- src/lib/mdx/preload.ts ---

/**
 * MDX Build-Time Preloader
 * 
 * This script compiles all MDX files during build time
 * to populate the cache and ensure optimal performance.
 * 
 * USAGE:
 * - Call from Next.js build process
 * - Or run as standalone script: node -r tsx/register scripts/preload-mdx.ts
 * 
 * BENEFITS:
 * - All MDX compiled before first request
 * - Catch compilation errors at build time
 * - Faster initial page loads
 */

import { getAllComponentsMetadata } from '@/lib/registry/resolver';
import { preloadComponentMDX } from '@/lib/mdx/loader';
import { getMDXCacheStats } from '@/lib/mdx/compiler';

/**
 * Preload all component MDX files
 * 
 * This should be called during the build process
 * to ensure all MDX is compiled and cached.
 */
export async function preloadAllMDX() {
  console.log('[MDX Preload] Starting MDX compilation...');
  const startTime = performance.now();

  // Get all component metadata from registry
  const components = getAllComponentsMetadata();
  const slugs = components.map(c => c.id);

  console.log(`[MDX Preload] Found ${slugs.length} components to process`);

  // Preload all MDX files
  const loaded = await preloadComponentMDX(slugs);

  const endTime = performance.now();
  const duration = Math.round(endTime - startTime);

  console.log(`[MDX Preload] ✓ Compiled ${loaded.size} MDX files in ${duration}ms`);

  // Show cache stats
  const stats = getMDXCacheStats();
  console.log(`[MDX Preload] Cache size: ${stats.size}/${stats.maxEntries}`);

  return loaded;
}

/**
 * Validate that all MDX files compile successfully
 * 
 * Returns list of components with MDX errors
 */
export async function validateMDXCompilation() {
  const components = getAllComponentsMetadata();
  const errors: Array<{ slug: string; error: string }> = [];

  for (const component of components) {
    try {
      const { loadComponentMDX } = await import('@/lib/mdx/loader');
      await loadComponentMDX(component.id);
    } catch (error) {
      errors.push({
        slug: component.id,
        error: error instanceof Error ? error.message : String(error),
      });
    }
  }

  if (errors.length > 0) {
    console.error('[MDX Validation] Compilation errors found:');
    errors.forEach(({ slug, error }) => {
      console.error(`  - ${slug}: ${error}`);
    });
  } else {
    console.log('[MDX Validation] ✓ All MDX files compiled successfully');
  }

  return errors;
}

// Run preloader if executed directly
if (require.main === module) {
  preloadAllMDX()
    .then(() => process.exit(0))
    .catch((error) => {
      console.error('[MDX Preload] Failed:', error);
      process.exit(1);
    });
}


--- src/lib/mdx/types.ts ---

/**
 * MDX Type Definitions
 * 
 * Core types for the compiled MDX system.
 * 
 * ARCHITECTURE NOTES:
 * - Frontmatter is extracted via gray-matter before compilation
 * - MDX content is compiled to React components (no section extraction)
 * - LoadedMDX (in loader.ts) is the primary interface for working with MDX
 */

export interface MDXFrontmatter {
  name: string;
  title: string;
  description: string;
  category: string;
  version?: string;
  source?: string;
  tags?: string[];
  dependencies?: string[];
  [key: string]: any;
}


--- src/lib/registry/registry.json ---

{
  "version": "1.0.0",
  "components": [
    {
      "id": "adaptive-tooltip",
      "title": "Adaptive Tooltip",
      "description": "Intelligent tooltip system that adapts to user intent with confidence-based delays and smooth animations.",
      "category": "ui",
      "status": "stable",
      "pricing": "free",
      "tags": [
        "framer-motion",
        "animejs",
        "clsx"
      ],
      "date": "2025-12-31",
      "featured": false,
      "new": false,
      "source": {
        "type": "mdx",
        "path": "src/content/adaptive-tooltip/index.mdx"
      },
      "demo": {
        "variants": [
          "default"
        ],
        "defaultProps": {}
      },
      "design": {
        "surface": "flat",
        "motion": "spring"
      },
      "dependencies": [
        "framer-motion",
        "animejs",
        "clsx"
      ]
    },
    {
      "id": "magnetic-button",
      "title": "Magnetic Button",
      "description": "Cursor-following button with magnetic attraction, GSAP-powered flair animation, and smooth physics.",
      "category": "ui",
      "status": "experimental",
      "pricing": "free",
      "tags": [
        "gsap",
        "animation",
        "ui"
      ],
      "date": "2026-01-07",
      "featured": false,
      "new": true,
      "source": {
        "type": "mdx",
        "path": "src/content/magnetic-button/index.mdx"
      },
      "demo": {
        "variants": [
          "default"
        ],
        "defaultProps": {}
      },
      "design": {
        "surface": "flat",
        "motion": "spring"
      },
      "dependencies": [
        "gsap",
        "react"
      ]
    },
    {
      "id": "filter-chips",
      "title": "Filter Chips",
      "description": "Animated filter chips with smooth shared layout transitions and spring physics for selection feedback.",
      "category": "ui",
      "status": "stable",
      "pricing": "free",
      "tags": [
        "framer-motion",
        "animation",
        "ui",
        "filter"
      ],
      "date": "2026-01-08",
      "featured": false,
      "new": true,
      "source": {
        "type": "mdx",
        "path": "src/content/filter-chips/index.mdx"
      },
      "demo": {
        "variants": [
          "default"
        ],
        "defaultProps": {}
      },
      "design": {
        "surface": "flat",
        "motion": "spring"
      },
      "dependencies": [
        "framer-motion"
      ]
    },
    {
      "id": "scroll-reveal-text",
      "title": "Scroll Reveal Text",
      "description": "Scroll-locked text reveal with glassmorphic pill overlays that emerge, glow, and dissolve as you scroll.",
      "category": "animation",
      "status": "stable",
      "pricing": "paid",
      "tags": [
        "framer-motion",
        "scroll",
        "animation",
        "text",
        "spring-physics"
      ],
      "date": "2026-01-11",
      "featured": false,
      "new": true,
      "source": {
        "type": "mdx",
        "path": "src/content/scroll-reveal-text/index.mdx"
      },
      "demo": {
        "external": "https://text-box-scroll.vercel.app/",
        "variants": [
          "default"
        ],
        "defaultProps": {},
        "scrollable": true,
        "minHeight": "700px"
      },
      "design": {
        "surface": "glassmorphic",
        "motion": "scroll-locked"
      },
      "dependencies": [
        "framer-motion"
      ]
    }
  ]
}


--- src/lib/registry/resolver.ts ---

import type { ComponentType } from "react";
import type { RegistryComponent } from "../types";
import registryData from "./registry.json";
import { RegistrySchema } from "./schema";

/**
 * Component Resolver
 *
 * This is the ONLY way demo components should be loaded.
 * - No direct imports in demo pages
 * - Uses dynamic imports for code splitting
 * - Registry-driven only
 *
 * INVARIANTS:
 * - Site pages ONLY read from registry
 * - Site pages NEVER manually import components
 * - Adding a new component requires NO site code changes
 * 
 * HOW TO ADD A NEW COMPONENT:
 * 1. Add entry to registry.json
 * 2. Create demo at src/components/demos/<id>/<PascalCase>Demo.tsx
 * 3. Add to demoImports object below (required for bundler static analysis)
 * 4. Create MDX at src/content/<id>/index.mdx
 * 
 * That's it! No other code changes needed.
 */

// Validate registry at load time (fail-fast)
let registry: { version: string; components: RegistryComponent[] };
try {
  const parsed = RegistrySchema.parse(registryData);
  registry = {
    version: parsed.version,
    components: parsed.components as RegistryComponent[],
  };
  console.info(`[resolver] Registry validated: v${registry.version}, ${registry.components.length} components`);
} catch (error) {
  console.error('[resolver] Registry validation FAILED:', error);
  throw new Error('Invalid registry.json - see console for details');
}

/**
 * Demo Import Registry
 *
 * STATIC IMPORT MAP - Required for bundler analysis and code splitting.
 * 
 * WHY THIS PATTERN:
 * - Dynamic import() with string interpolation breaks tree-shaking
 * - Webpack/Turbopack needs static paths to create split chunks
 * - This is the minimal touch point: just add one line per component
 * 
 * NAMING CONVENTION:
 * - Key: matches registry.json `id` (kebab-case)
 * - Path: @/components/demos/{id}/{PascalCase}Demo
 * - Export: default export
 */
const demoImports = {
  "adaptive-tooltip": () => import("@/components/demos/adaptive-tooltip/AdaptiveTooltipDemo"),
  "magnetic-button": () => import("@/components/demos/magnetic-button/MagneticButtonDemo"),
  "filter-chips": () => import("@/components/demos/filter-chips/FilterChipsDemo"),
  "scroll-reveal-text": () => import("@/components/demos/scroll-reveal-text/ScrollRevealTextDemo"),
} as const satisfies Record<string, () => Promise<{ default: ComponentType<Record<string, unknown>> }>>;

type DemoId = keyof typeof demoImports;

/* ──────────────────────────────────────────────────────────────── */
/* Runtime Assertions                                                */
/* ──────────────────────────────────────────────────────────────── */

/**
 * Validate registry integrity at runtime.
 * Checks that all registry entries have corresponding demo mappings.
 */
function validateRegistryIntegrity(): void {
  const registryIds = new Set(registry.components.map((c) => c.id));
  const importMapIds = new Set(Object.keys(demoImports));

  // Check for registry entries without demos
  const missingDemos = Array.from(registryIds).filter(
    (id) => !importMapIds.has(id)
  );

  if (missingDemos.length > 0) {
    console.error(
      `[resolver] Registry validation failed!\n` +
      `The following components are in registry.json but have no demo mapping:\n` +
      `  ${missingDemos.join(", ")}\n` +
      `Add entry to demoImports in src/lib/registry/resolver.ts`
    );
  }

  // Check for demos without registry entries
  const orphanedDemos = Array.from(importMapIds).filter(
    (id) => !registryIds.has(id)
  );

  if (orphanedDemos.length > 0) {
    console.warn(
      `[resolver] Demo imports have entries not in registry:\n` +
      `  ${orphanedDemos.join(", ")}\n` +
      `These demos will never be used.`
    );
  }

  if (missingDemos.length === 0 && orphanedDemos.length === 0) {
    console.info(
      `[resolver] Registry validation passed: ${registryIds.size} components registered`
    );
  }
}

// Run validation at module load (browser only)
if (typeof window !== "undefined") {
  validateRegistryIntegrity();
}

/* ──────────────────────────────────────────────────────────────── */
/* Registry Queries                                                  */
/* ──────────────────────────────────────────────────────────────── */

export function getComponentMetadata(
  id: string
): RegistryComponent | null {
  return registry.components.find((c) => c.id === id) ?? null;
}

export function getAllComponentsMetadata(): RegistryComponent[] {
  return registry.components;
}

export function getFeaturedComponentsMetadata(): RegistryComponent[] {
  return registry.components.filter((c) => c.featured);
}

export function getComponentsByCategory(
  category: string
): RegistryComponent[] {
  return registry.components.filter((c) => c.category === category);
}

export function getAllCategories(): string[] {
  return Array.from(
    new Set(registry.components.map((c) => c.category))
  ).sort();
}

/* ──────────────────────────────────────────────────────────────── */
/* Component Resolution                                              */
/* ──────────────────────────────────────────────────────────────── */

/**
 * Resolve and dynamically import a demo component by registry ID.
 *
 * This function:
 * - Validates registry existence
 * - Imports demo via explicit import map
 * - Returns the demo component and metadata
 *
 * @throws Error (controlled, descriptive)
 */
export async function resolveComponent(
  id: string
): Promise<{
  Component: ComponentType<Record<string, unknown>>;
  metadata: RegistryComponent;
}> {
  const metadata = getComponentMetadata(id);

  if (!metadata) {
    throw new Error(
      `Component "${id}" not found in registry. ` +
      `Available components: ${registry.components
        .map((c) => c.id)
        .join(", ")}`
    );
  }

  const importFn = demoImports[id as DemoId];

  if (!importFn) {
    throw new Error(
      `Component "${id}" is registered but has no demo import. ` +
      `Add an entry to demoImports in src/lib/registry/resolver.ts`
    );
  }

  try {
    const module = await importFn();
    const Component = module.default;

    if (!Component) {
      throw new Error(
        `No default export found for demo "${id}".`
      );
    }

    return { Component, metadata };
  } catch (error) {
    throw new Error(
      `Failed to resolve demo for "${id}". ` +
      `Error: ${error instanceof Error
        ? error.message
        : String(error)
      }`
    );
  }
}


--- src/lib/registry/schema.ts ---

/**
 * Registry Schema
 * 
 * Zod schemas for runtime validation of registry.json
 * Ensures data integrity and provides clear error messages on parse failures.
 */

import { z } from 'zod';

// Component category enum
export const ComponentCategorySchema = z.enum([
    'animation',
    'interaction',
    'form',
    'navigation',
    'layout',
    'visual',
    'data-display',
    'feedback',
    'ui',
]);

// Component status enum
export const ComponentStatusSchema = z.enum(['stable', 'experimental', 'deprecated']);

// Component pricing enum
export const ComponentPricingSchema = z.enum(['free', 'paid']);

// Component source type enum
export const ComponentSourceTypeSchema = z.enum(['local', 'remote', 'user-uploaded', 'mdx']);

// Component source schema
export const ComponentSourceSchema = z.object({
    type: ComponentSourceTypeSchema,
    path: z.string().min(1),
    url: z.string().url().optional(),
});

// Component demo schema
export const ComponentDemoSchema = z.object({
    variants: z.array(z.string()).default(['default']),
    defaultProps: z.record(z.string(), z.unknown()).default({}),
    scrollable: z.boolean().optional(),
    external: z.string().url().optional(),
    minHeight: z.string().optional(),
});

// Component design schema
export const ComponentDesignSchema = z.object({
    surface: z.enum(['flat', 'elevated', 'inset', 'glassmorphic']),
    motion: z.enum(['spring', 'smooth', 'linear', 'none', 'scroll-locked']),
});

// Author schema
export const AuthorSchema = z.object({
    name: z.string().min(1),
    url: z.string().url().optional(),
});

// Single component schema
export const RegistryComponentSchema = z.object({
    id: z.string().regex(/^[a-z0-9-]+$/, 'Component ID must be lowercase alphanumeric with hyphens'),
    title: z.string().min(1),
    description: z.string().min(1),
    category: ComponentCategorySchema,
    status: ComponentStatusSchema,
    pricing: ComponentPricingSchema,
    tags: z.array(z.string()).default([]),
    date: z.string().regex(/^\d{4}-\d{2}-\d{2}$/, 'Date must be YYYY-MM-DD format'),
    featured: z.boolean().optional().default(false),
    new: z.boolean().optional().default(false),
    source: ComponentSourceSchema,
    demo: ComponentDemoSchema,
    design: ComponentDesignSchema,
    readme: z.string().optional(),
    dependencies: z.array(z.string()).optional().default([]),
    author: AuthorSchema.optional(),
});

// Full registry schema
export const RegistrySchema = z.object({
    version: z.string().regex(/^\d+\.\d+\.\d+$/, 'Version must be semver format'),
    components: z.array(RegistryComponentSchema),
});

// Type exports for use in other files
export type RegistryComponent = z.infer<typeof RegistryComponentSchema>;
export type Registry = z.infer<typeof RegistrySchema>;


--- src/lib/source-reader.ts ---

import fs from "fs";
import { promises as fsPromises } from "fs";
import path from "path";
import { getComponentMetadata } from "./registry/resolver";
import { SecurityError } from "./errors";

/**
 * Valid component ID pattern.
 * Only lowercase letters, numbers, and hyphens allowed.
 * This prevents path traversal attacks like "../../../etc/passwd"
 */
const VALID_COMPONENT_ID = /^[a-z0-9-]+$/;

/**
 * Validates a component ID for security.
 * 
 * @throws SecurityError if the ID format is invalid or component doesn't exist
 */
function validateComponentId(componentId: string): void {
  // Check format first (prevents path traversal)
  if (!VALID_COMPONENT_ID.test(componentId)) {
    throw new SecurityError(
      `Invalid component ID format: "${componentId}"`,
      'INVALID_ID_FORMAT'
    );
  }

  // Verify component exists in registry (whitelist approach)
  const metadata = getComponentMetadata(componentId);
  if (!metadata) {
    throw new SecurityError(
      `Unknown component: "${componentId}"`,
      'UNKNOWN_COMPONENT'
    );
  }
}

/**
 * Convert kebab-case to PascalCase
 */
function toPascalCase(str: string): string {
  return str
    .split("-")
    .map((w) => w.charAt(0).toUpperCase() + w.slice(1))
    .join("");
}

/* ──────────────────────────────────────────────────────────────────────────────
 * ASYNC VERSIONS (Preferred for API routes)
 * ────────────────────────────────────────────────────────────────────────────── */

/**
 * Get Demo Source Code (Async)
 * 
 * Non-blocking version for use in API routes.
 * 
 * @param componentId - The component ID (e.g., "adaptive-tooltip")
 * @returns The source code string or null if not found
 * @throws SecurityError if componentId is invalid or unknown
 */
export async function getDemoSourceCodeAsync(componentId: string): Promise<string | null> {
  validateComponentId(componentId);

  try {
    const pascalName = toPascalCase(componentId);
    const demoPath = path.join(
      process.cwd(),
      `src/components/demos/${componentId}/${pascalName}Demo.tsx`
    );

    try {
      await fsPromises.access(demoPath);
    } catch {
      console.warn(`[getDemoSourceCodeAsync] Demo file not found: ${demoPath}`);
      return null;
    }

    return await fsPromises.readFile(demoPath, "utf8");
  } catch (error) {
    console.error(`[getDemoSourceCodeAsync] Error reading demo for ${componentId}:`, error);
    return null;
  }
}

/**
 * Get Component Source Code (Async)
 * 
 * Non-blocking version for use in API routes.
 * 
 * @param componentId - The component ID (e.g., "adaptive-tooltip")
 * @returns The source code string or null if not found
 * @throws SecurityError if componentId is invalid or unknown
 */
export async function getComponentSourceCodeAsync(componentId: string): Promise<string | null> {
  validateComponentId(componentId);

  try {
    const pascalName = toPascalCase(componentId);
    const extensions = [".tsx", ".framer.tsx", ".ts"];
    let componentPath = "";

    for (const ext of extensions) {
      // Check for PascalCase first
      const pascalPath = path.join(
        process.cwd(),
        `src/content/${componentId}/${pascalName}${ext}`
      );
      try {
        await fsPromises.access(pascalPath);
        componentPath = pascalPath;
        break;
      } catch {
        // Try next
      }

      // Fallback to kebab-case
      const kebabPath = path.join(
        process.cwd(),
        `src/content/${componentId}/${componentId}${ext}`
      );
      try {
        await fsPromises.access(kebabPath);
        componentPath = kebabPath;
        break;
      } catch {
        // Try next
      }
    }

    if (!componentPath) {
      console.warn(`[getComponentSourceCodeAsync] Component file not found for: ${componentId}`);
      return null;
    }

    return await fsPromises.readFile(componentPath, "utf8");
  } catch (error) {
    console.error(`[getComponentSourceCodeAsync] Error reading component ${componentId}:`, error);
    return null;
  }
}

/* ──────────────────────────────────────────────────────────────────────────────
 * SYNC VERSIONS (For backward compatibility)
 * ────────────────────────────────────────────────────────────────────────────── */

/**
 * Get Demo Source Code (Sync)
 * 
 * @deprecated Use getDemoSourceCodeAsync for API routes
 */
export function getDemoSourceCode(componentId: string): string | null {
  validateComponentId(componentId);

  try {
    const pascalName = toPascalCase(componentId);
    const demoPath = path.join(
      process.cwd(),
      `src/components/demos/${componentId}/${pascalName}Demo.tsx`
    );

    if (!fs.existsSync(demoPath)) {
      console.warn(`[getDemoSourceCode] Demo file not found: ${demoPath}`);
      return null;
    }

    return fs.readFileSync(demoPath, "utf8");
  } catch (error) {
    console.error(`[getDemoSourceCode] Error reading demo for ${componentId}:`, error);
    return null;
  }
}

/**
 * Get Component Source Code (Sync)
 * 
 * @deprecated Use getComponentSourceCodeAsync for API routes
 */
export function getComponentSourceCode(componentId: string): string | null {
  validateComponentId(componentId);

  try {
    const pascalName = toPascalCase(componentId);
    const extensions = [".tsx", ".framer.tsx", ".ts"];
    let componentPath = "";

    for (const ext of extensions) {
      const pascalPath = path.join(
        process.cwd(),
        `src/content/${componentId}/${pascalName}${ext}`
      );
      if (fs.existsSync(pascalPath)) {
        componentPath = pascalPath;
        break;
      }

      const kebabPath = path.join(
        process.cwd(),
        `src/content/${componentId}/${componentId}${ext}`
      );
      if (fs.existsSync(kebabPath)) {
        componentPath = kebabPath;
        break;
      }
    }

    if (!componentPath) {
      console.warn(`[getComponentSourceCode] Component file not found for: ${componentId}`);
      return null;
    }

    return fs.readFileSync(componentPath, "utf8");
  } catch (error) {
    console.error(`[getComponentSourceCode] Error reading component ${componentId}:`, error);
    return null;
  }
}



--- src/lib/types.ts ---

import React from "react";

export type ComponentCategory = 
  | "animation" 
  | "interaction" 
  | "form" 
  | "navigation" 
  | "layout" 
  | "visual" 
  | "data-display" 
  | "feedback"
  | "ui";

export type ComponentStatus = "stable" | "experimental" | "deprecated";

export type ComponentPricing = "free" | "paid";

export type ComponentSourceType = "local" | "remote" | "user-uploaded" | "mdx";

export interface ComponentSource {
  type: ComponentSourceType;
  path: string;
  url?: string;
}

export interface ComponentDemo {
  variants: string[];
  defaultProps: Record<string, any>;
  /** Whether this component needs a scroll container */
  scrollable?: boolean;
  /** External demo URL */
  external?: string;
  /** Minimum height for demo container */
  minHeight?: string;
}

export interface ComponentDesign {
  surface: "flat" | "elevated" | "inset" | "glassmorphic";
  motion: "spring" | "smooth" | "linear" | "none" | "scroll-locked";
}

export interface RegistryComponent {
  id: string;
  title: string;
  description: string;
  category: ComponentCategory;
  status: ComponentStatus;
  pricing: ComponentPricing;
  tags: string[];
  date: string;
  featured?: boolean;
  new?: boolean;
  source: ComponentSource;
  demo: ComponentDemo;
  design: ComponentDesign;
  readme?: string;
  dependencies?: string[];
  author?: {
    name: string;
    url?: string;
  };
}

export interface ComponentRegistry {
  version: string;
  components: RegistryComponent[];
}

export interface NavItem {
  title: string;
  href: string;
  icon?: any;
}

export interface NavSection {
  title: string;
  items: NavItem[];
}


--- src/lib/utils.ts ---

import { type ClassValue, clsx } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}


--- src/tests/unit/source-reader.spec.ts ---

/**
 * Unit Tests: source-reader.ts
 * 
 * Tests for path traversal prevention and input validation.
 */

import { describe, it, expect, vi, beforeEach } from 'vitest';
import { getDemoSourceCode, getComponentSourceCode } from '@/lib/source-reader';
import { SecurityError } from '@/lib/errors';

// Mock the fs module
vi.mock('fs', () => ({
    default: {
        existsSync: vi.fn(() => true),
        readFileSync: vi.fn(() => 'mock source code'),
    },
    existsSync: vi.fn(() => true),
    readFileSync: vi.fn(() => 'mock source code'),
}));

// Mock the registry resolver
vi.mock('@/lib/registry/resolver', () => ({
    getComponentMetadata: vi.fn((id: string) => {
        const validComponents: Record<string, any> = {
            'adaptive-tooltip': { id: 'adaptive-tooltip', pricing: 'free' },
            'magnetic-button': { id: 'magnetic-button', pricing: 'free' },
            'filter-chips': { id: 'filter-chips', pricing: 'paid' },
            'scroll-reveal-text': { id: 'scroll-reveal-text', pricing: 'free' },
        };
        return validComponents[id] || null;
    }),
}));

describe('source-reader', () => {
    describe('getDemoSourceCode', () => {
        it('should throw SecurityError for path traversal attempts', () => {
            expect(() => getDemoSourceCode('../etc/passwd')).toThrow(SecurityError);
            expect(() => getDemoSourceCode('../../secret')).toThrow(SecurityError);
            expect(() => getDemoSourceCode('..\\..\\windows\\system32')).toThrow(SecurityError);
        });

        it('should throw SecurityError with INVALID_ID_FORMAT code for malformed IDs', () => {
            try {
                getDemoSourceCode('../etc/passwd');
            } catch (err) {
                expect(err).toBeInstanceOf(SecurityError);
                expect((err as SecurityError).code).toBe('INVALID_ID_FORMAT');
            }
        });

        it('should throw SecurityError for unknown components', () => {
            expect(() => getDemoSourceCode('nonexistent-component')).toThrow(SecurityError);
        });

        it('should throw SecurityError with UNKNOWN_COMPONENT code', () => {
            try {
                getDemoSourceCode('unknown-component');
            } catch (err) {
                expect(err).toBeInstanceOf(SecurityError);
                expect((err as SecurityError).code).toBe('UNKNOWN_COMPONENT');
            }
        });

        it('should return source code for valid component IDs', () => {
            const result = getDemoSourceCode('adaptive-tooltip');
            expect(result).toBe('mock source code');
        });

        it('should allow lowercase letters, numbers, and hyphens only', () => {
            // These should all throw for format violations
            expect(() => getDemoSourceCode('Component')).toThrow(SecurityError); // uppercase
            expect(() => getDemoSourceCode('my_component')).toThrow(SecurityError); // underscore
            expect(() => getDemoSourceCode('my.component')).toThrow(SecurityError); // dot
            expect(() => getDemoSourceCode('my component')).toThrow(SecurityError); // space
        });
    });

    describe('getComponentSourceCode', () => {
        it('should throw SecurityError for path traversal attempts', () => {
            expect(() => getComponentSourceCode('../etc/passwd')).toThrow(SecurityError);
            expect(() => getComponentSourceCode('../../secret')).toThrow(SecurityError);
        });

        it('should throw SecurityError for unknown components', () => {
            expect(() => getComponentSourceCode('fake-component')).toThrow(SecurityError);
        });

        it('should return source code for valid component IDs', () => {
            const result = getComponentSourceCode('magnetic-button');
            expect(result).toBe('mock source code');
        });
    });
});


--- tailwind.config.ts ---

import type { Config } from "tailwindcss";

const config: Config = {
  darkMode: "class",
  content: [
    "./src/pages/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/components/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/app/**/*.{js,ts,jsx,tsx,mdx}",
  ],
  theme: {
    extend: {
      colors: {
        'muted-2': 'var(--muted-2)',
        'muted-3': 'var(--muted-3)',
      },
      fontFamily: {
        sans: ['var(--font-sans)', 'ui-sans-serif', 'system-ui', 'sans-serif'],
        mono: ['Consolas', 'ui-monospace', 'SFMono-Regular', 'Menlo', 'Monaco', 'Liberation Mono', 'Courier New', 'monospace'],
      },
    },
  },
  plugins: [require("@tailwindcss/typography")],
};

export default config;


--- vitest.config.ts ---

import { defineConfig } from 'vitest/config';
import path from 'path';

export default defineConfig({
    test: {
        globals: true,
        environment: 'node',
        include: ['src/tests/**/*.spec.ts', 'src/tests/**/*.test.ts'],
        coverage: {
            reporter: ['text', 'json', 'html'],
            include: ['src/lib/**/*.ts', 'src/app/api/**/*.ts'],
            exclude: ['src/tests/**', 'node_modules/**'],
        },
    },
    resolve: {
        alias: {
            '@': path.resolve(__dirname, './src'),
        },
    },
});
